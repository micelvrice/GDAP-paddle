/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-30 11:14:19,938] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
=======================================================================
I1230 11:14:19.939536 4019286 tcp_utils.cc:181] The server starts to listen on IP_ANY:48565
I1230 11:14:19.939718 4019286 tcp_utils.cc:130] Successfully connected to 10.3.242.26:48565
I1230 11:14:20.123523 4019286 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:14:20.124344 4019286 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:14:20,125] [    INFO] topology.py:370 - Total 8 pipe comm group(s) create successfully!
W1230 11:14:20.289165 4019286 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1230 11:14:20.291596 4019286 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-30 11:14:23,587] [    INFO] topology.py:370 - Total 8 data comm group(s) create successfully!
[2024-12-30 11:14:23,587] [    INFO] topology.py:370 - Total 8 model comm group(s) create successfully!
I1230 11:14:23.587817 4019286 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:14:23.587842 4019286 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:14:23,587] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1230 11:14:23.587929 4019286 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:14:23.587934 4019286 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:14:23,588] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 8, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3, 4, 5, 6, 7], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3, 4, 5, 6, 7]
[32m[2024-12-30 11:14:23,588] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-30 11:14:23,588] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
Traceback (most recent call last):
  File "/home/sjx/tr-paddle-1230/llm/run_finetune.py", line 679, in <module>
    main()
  File "/home/sjx/tr-paddle-1230/llm/run_finetune.py", line 96, in main
    gen_args, model_args, reft_args, data_args, training_args = parser.parse_json_file_and_cmd_lines()
  File "/home/sjx/tr-paddle-1230/paddlenlp/trainer/argparser.py", line 299, in parse_json_file_and_cmd_lines
    return self.common_parse(args, return_remaining_strings)
  File "/home/sjx/tr-paddle-1230/paddlenlp/trainer/argparser.py", line 252, in common_parse
    raise ValueError(f"Some specified arguments are not used by the PdArgumentParser: {remaining_args}")
ValueError: Some specified arguments are not used by the PdArgumentParser: ['--rope_scaling_type', 'linear']
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-30 11:19:32,055] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
=======================================================================
I1230 11:19:32.056738 4022985 tcp_utils.cc:181] The server starts to listen on IP_ANY:38255
I1230 11:19:32.056923 4022985 tcp_utils.cc:130] Successfully connected to 10.3.242.26:38255
I1230 11:19:35.215515 4022985 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:19:35.215597 4022985 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:19:35,216] [    INFO] topology.py:370 - Total 8 pipe comm group(s) create successfully!
W1230 11:19:35.282927 4022985 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1230 11:19:35.285410 4022985 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-30 11:19:37,667] [    INFO] topology.py:370 - Total 8 data comm group(s) create successfully!
[2024-12-30 11:19:37,668] [    INFO] topology.py:370 - Total 8 model comm group(s) create successfully!
I1230 11:19:37.668315 4022985 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:19:37.668345 4022985 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:19:37,668] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1230 11:19:37.668443 4022985 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:19:37.668448 4022985 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:19:37,668] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 8, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3, 4, 5, 6, 7], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3, 4, 5, 6, 7]
[32m[2024-12-30 11:19:37,668] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-30 11:19:37,669] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-30 11:19:37,669] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-30 11:19:37,669] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-30 11:19:37,669] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-30 11:19:37,669] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-30 11:19:37,669] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-30 11:19:37,669] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-30 11:19:37,670] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-30 11:19:37,671] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - [0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-30 11:19:37,672] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - [0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-30 11:19:37,673] [   DEBUG][0m - [0m
[32m[2024-12-30 11:19:37,675] [    INFO][0m - The global seed is set to 42, local seed is set to 50 and random seed is set to 42.[0m
[33m[2024-12-30 11:19:37,675] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 8, distributed training: True, 16-bits training: True[0m
[32m[2024-12-30 11:19:37,676] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-30 11:19:37,677] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241230",
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-30 11:19:37,678] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling.LlamaForCausalLM'> to load 'meta-llama/Llama-2-7b'.[0m
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-30 11:26:13,440] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
=======================================================================
I1230 11:26:13.441473 4028342 tcp_utils.cc:181] The server starts to listen on IP_ANY:38214
I1230 11:26:13.441653 4028342 tcp_utils.cc:130] Successfully connected to 10.3.242.26:38214
I1230 11:26:16.531482 4028342 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:26:16.531554 4028342 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:26:16,532] [    INFO] topology.py:370 - Total 8 pipe comm group(s) create successfully!
W1230 11:26:16.553761 4028342 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1230 11:26:16.556177 4028342 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-30 11:26:18,622] [    INFO] topology.py:370 - Total 8 data comm group(s) create successfully!
[2024-12-30 11:26:18,622] [    INFO] topology.py:370 - Total 8 model comm group(s) create successfully!
I1230 11:26:18.623131 4028342 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:26:18.623157 4028342 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:26:18,623] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1230 11:26:18.623257 4028342 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1230 11:26:18.623263 4028342 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-30 11:26:18,623] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 8, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3, 4, 5, 6, 7], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3, 4, 5, 6, 7]
[32m[2024-12-30 11:26:18,623] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-30 11:26:18,624] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-30 11:26:18,624] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-30 11:26:18,625] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - [0m
[35m[2024-12-30 11:26:18,626] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-30 11:26:18,627] [   DEBUG][0m - [0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-30 11:26:18,628] [   DEBUG][0m - [0m
[32m[2024-12-30 11:26:18,629] [    INFO][0m - The global seed is set to 42, local seed is set to 50 and random seed is set to 42.[0m
[33m[2024-12-30 11:26:18,629] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 8, distributed training: True, 16-bits training: True[0m
[32m[2024-12-30 11:26:18,630] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-30 11:26:18,632] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241230",
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-30 11:26:18,633] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling.LlamaForCausalLM'> to load 'meta-llama/Llama-2-7b'.[0m
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-31 15:51:45,531] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
=======================================================================
I1231 15:51:45.533691 82297 tcp_utils.cc:181] The server starts to listen on IP_ANY:38873
I1231 15:51:45.533834 82297 tcp_utils.cc:130] Successfully connected to 10.3.242.26:38873
I1231 15:51:45.619269 82297 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 15:51:45.619302 82297 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 15:51:45,619] [    INFO] topology.py:370 - Total 4 pipe comm group(s) create successfully!
W1231 15:51:45.639166 82297 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 15:51:45.640087 82297 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-31 15:51:47,454] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 15:51:47,455] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
I1231 15:51:47.455166 82297 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 15:51:47.455183 82297 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 15:51:47,455] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1231 15:51:47.455252 82297 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 15:51:47.455256 82297 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 15:51:47,455] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 4, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 15:51:47,455] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 15:51:47,455] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 15:51:47,455] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:51:47,455] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 15:51:47,456] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - [0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 15:51:47,457] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - [0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 15:51:47,458] [   DEBUG][0m - [0m
[32m[2024-12-31 15:51:47,459] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 15:51:47,460] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 15:51:47,460] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 15:51:47,461] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 15:51:47,461] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling.LlamaForCausalLM'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 15:51:47,462] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 15:53:05,438] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-31 15:56:39,007] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
=======================================================================
I1231 15:56:39.008649 85664 tcp_utils.cc:181] The server starts to listen on IP_ANY:48936
I1231 15:56:39.008800 85664 tcp_utils.cc:130] Successfully connected to 10.3.242.26:48936
I1231 15:56:42.071679 85664 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 15:56:42.071760 85664 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 15:56:42,072] [    INFO] topology.py:370 - Total 4 pipe comm group(s) create successfully!
W1231 15:56:42.078006 85664 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 15:56:42.080502 85664 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-31 15:56:43,113] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 15:56:43,114] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
I1231 15:56:43.114125 85664 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 15:56:43.114148 85664 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 15:56:43,114] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1231 15:56:43.114219 85664 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 15:56:43.114224 85664 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 15:56:43,114] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 4, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 15:56:43,114] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 15:56:43,114] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 15:56:43,114] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 15:56:43,115] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - [0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:56:43,116] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - [0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 15:56:43,117] [   DEBUG][0m - [0m
[32m[2024-12-31 15:56:43,119] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 15:56:43,119] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 15:56:43,119] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 15:56:43,121] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 15:56:43,121] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling.LlamaForCausalLM'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 15:56:43,122] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 15:57:43,834] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[32m[2024-12-31 15:58:45,621] [    INFO][0m - All model checkpoint weights were used when initializing LlamaForCausalLM.
[0m
[32m[2024-12-31 15:58:45,622] [    INFO][0m - All the weights of LlamaForCausalLM were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.[0m
[32m[2024-12-31 15:58:45,624] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/generation_config.json[0m
[32m[2024-12-31 15:58:47,239] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 15:58:47,300] [   DEBUG][0m - Frozen parameters: 6.74e+09 || Trainable parameters:2.00e+07 || Total parameters:6.76e+09|| Trainable:0.30%[0m
[35m[2024-12-31 15:58:47,300] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 15:58:52,434] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 15:58:52,549] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 15:58:52,621] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - dataset_world_size            : 4[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 15:58:52,622] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - eval_batch_size               : 8[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 15:58:52,623] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_15-56-39_ubuntu[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 15:58:52,624] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - optimizer_name_suffix         : shard00[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - per_device_eval_batch_size    : 8[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - per_device_train_batch_size   : 4[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - pipeline_parallel_degree      : 1[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 15:58:52,625] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding                      : [<ShardingOption.SHARD_OP: 'stage1'>][0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding_parallel_degree      : 4[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 15:58:52,626] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - train_batch_size              : 4[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 15:58:52,627] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - weight_name_suffix            : [0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 15:58:52,628] [   DEBUG][0m - [0m
[32m[2024-12-31 15:58:52,629] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 15:58:52,678] [    INFO] sharding_parallel.py:30 - start broadcast sharding parameters
[2024-12-31 15:58:53,448] [    INFO] sharding_parallel.py:37 - sharding's parameters is ready
[2024-12-31 15:58:53,449] [    INFO] dygraph_sharding_optimizer.py:71 - init DygraphShardingOptimizer
[2024-12-31 15:58:53,451] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 15:58:54,058] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 15:58:54) [0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Instantaneous batch size per device = 4[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 64[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Total optimization steps = 23[0m
[32m[2024-12-31 15:58:54,058] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 15:58:54,062] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (per device)[0m
Exception in thread Thread-3 (_thread_loop):
Traceback (most recent call last):
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 245, in _thread_loop
    batch = self._dataset_fetcher.fetch(
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
  File "/home/sjx/tr-paddle-1230/paddlenlp/datasets/dataset.py", line 266, in __getitem__
    return self._transform(self.new_data[idx]) if self._transform_pipline else self.new_data[idx]
  File "/home/sjx/tr-paddle-1230/paddlenlp/datasets/dataset.py", line 258, in _transform
    data = fn(data)
  File "/home/sjx/tr-paddle-1230/llm/utils/data.py", line 204, in convert_example_common
    tokenized_source = tokenize_unsupervised_example(
  File "/home/sjx/tr-paddle-1230/llm/utils/data.py", line 78, in tokenize_unsupervised_example
    raise DataFormatError(
utils.data.DataFormatError: Example format is wrong, please check: {'text': "\\section{Introduction}\n\nIt is well-known that the positive energy theorems ensure the energies of\nthe solutions approaching AdS spacetime globally cannot be negative\\cite{Yau,Witten,Gibbons}%\n. However, if the considering spacetimes are locally asymptotically\nAdS but not globally, the positive energy theorem may not hold. The\nHorowitz-Myers AdS soliton solution is this kind of particular\nsolution~\\cite{Horowitz}. This AdS soliton solution is important not\nonly for its negative energy, but also for the agreement with the\nCasimir energy in the field theory viewed from the AdS/CFT\ncorrespondence\\cite{Maldacena}. Furthermore, it has also been found\nthat there is a similar phase transition like the Hawking-Page phase\ntransition between the Ricci flat black hole and the AdS soliton\nsolution, and it could be connected with the\nconfinement/deconfinement phase transition in QCD\n\\cite{Hawking,Witt,Cai}.\n\nAlthough many properties of this AdS soliton solution have been\nstudied, the analogy of its energy and tension laws is absent, and\nit is simply because its entropy is zero and the period of the\nimaginary time is arbitrary. Recently, inspired from the interchange\nsymmetry between the KK bubble and the corresponding black hole\nwhich are all asymptotically flat, D.Kastor et al obtained some\ninteresting results of the KK bubble after defining some new\nquantities such as its surface gravity and the area of the KK\nbubble~\\cite{Kastor}(Note that the surface gravity here is\nassociated with the spacelike Killing field which translates around\nthe compact spatial coordinate, and more details can be found in\n\\cite{Gibbons2}). In our paper, viewed from the similar interchange\nsymmetry between the AdS soliton solution and the Ricci flat black\nhole, we first reinvestigate the energy and tension laws of the\nRicci flat black hole by considering the contribution of the tension\nterm \\cite{Tension,Kastor,Kurita,Traschen,Townsend}, then we\ninvestigate the analogy of the laws of the AdS soliton solution. We\nfind the same analogy as that of the laws of the KK bubble. In\naddition, we also investigate the laws of the boosted Ricci flat\nblack hole~\\cite{Kastor2}. The boosted Ricci flat black hole can be\nobtained from the static Ricci flat black hole by a boost\ntransformation along the compact spatial coordinate~\\cite{Cai2}.\nNote that, because the spatial coordinate is compact, the boosted\nRicci flat black hole is not equivalent to the static one\nglobally~\\cite{Lemos,Awad,Cai2}. And these kind of globally\nstationary but locally static spacetimes could be considered as the\ngravitational analog of the Aharonow-Bohm\neffect~\\cite{Aharonow,Stachel}. Similarly, for the static AdS\nsoliton solution, we can also make a boost transformation along the\ncompact spatial coordinate of the static AdS soliton solution, and\nthen obtain the boosted AdS soliton solution. Like the AdS soliton\nsolution, the boosted AdS soliton solution also has the same\ninterchange symmetry with the above boosted Ricci flat black hole.\nHowever, there are closed timelike curves and conical singularity in\nthe boosted AdS soliton solution, thus this solution is ill in\nphysics and the direct analogy of the energy and tension laws of the\nboosted AdS soliton solution is of no sense. In spite of that, its\nconserved charges such as the energy and momentum are well-defined,\nand an interesting result is that the energy of the boosted AdS\nsoliton is lower than that of the AdS soliton. On the other hand,\nnote that although here we can easily find that the energy and\ntension laws of the boosted Ricci flat black hole or the AdS soliton\nsolution are the same as those of the asymptotical flat case, the\nunderlying contents are not the same. First of all, the methods of\ncalculating the conserved charges are different. Because what they\ndiscuss are the asymptotically flat cases, the well-known ADM\ncalculation can be used in their cases~\\cite{Kastor,Kastor2}.\nHowever, it is invalid and there have been several methods to\ncalculate the conserved charges in the asymptotically AdS\ncase~\\cite{Counterterm,Euclidean,HH,AD,AM,Brown}. Here we just use\nthe surface counterterm method or Euclidean method. Second, they\nobtain the laws by using the Hamiltonian perturbation theory\ntechniques~\\cite{Traschen,Perturbation technique}, and more\nexpressive is that they should use the Hamiltonian formalism\npresented by the ADM method~\\cite{Kastor,Kastor2}. While for black\nholes we obtain the laws just by applying the Euclidean\nmethod~\\cite{Euclidean}, and basing on this we obtain the laws of\nAdS soliton by using the property of interchange symmetry. During\nthe derivation of laws, we do not need the explicit formalisms of\nconserved charges. Thus, our results could also be considered as a\nsimple generalization of the results in asymptotically flat case to\nthe asymptotically AdS case~\\cite{Kastor,Kastor2}.\n\n\nThe rest of paper is organized as follows. In section II, we\nreinvestigate the energy and tension laws of the Ricci flat black\nhole by considering the contribution of the tension term. In section\nIII, inspired from the interchange symmetry with the Ricci flat\nblack hole, we obtain the analogy of the laws of the AdS soliton\nsolution. In section IV, we generalize the above discussion in\nsection II to the case of the boosted Ricci flat black hole. In\nsection V, we consider the boosted AdS soliton solution. Finally, in\nsection VI, we give a brief conclusion and discussion.\n\n\n\\section{Reinvestigation of the energy and tension laws of the Ricci flat black hole%\n} The so-called Ricci flat black hole solution considered here is\n\\cite{Horowitz,Maldacena}\n\\begin{equation}\nds^{2}=\\frac{r^{2}}{l^{2}}[-(1-\\frac{r_{0}^{4}}{r^{4}}%\n)dt^{2}+dy^{2}+(dx^{i})^{2}]+(1-\\frac{r_{0}^{4}}{r^{4}})^{-1}\\frac{l^{2}}{%\nr^{2}}dr^{2}.\\ \\ (i=1,2) \\label{Ricci flat black hole}\n\\end{equation}%\nwhich arises in the near-horizon geometry of p-brane and is\nasymptotically the five dimensional AdS metric. It is easy to find\nthat its event horizon locates at $r_{+}=r_{0}$. And in order to\nremove the conical singularity at the horizon, the Euclidean time\n$\\tau $ must have a period $\\beta =\\frac{\\pi l^{2}}{r_{0}}$. Note\nthat, the coordinate $y$ is a compact spatial coordinate, and its\nperiod is $\\eta $. As the usual treatment, we can use the Euclidean\nmethod to research the thermodynamics of the Ricci flat black\nhole~\\cite{Euclidean}. Choosing the pure AdS spacetime as the\nreference background, we can easily obtain the Euclidean action of\nthe Ricci flat black hole\n\\begin{eqnarray}\nI_{E}=-\\frac{\\beta r_{0}^{4}}{16\\pi l^{5}}\\eta V_{2}.\n\\label{Euclidean action1}\n\\end{eqnarray}\nwhere $V_{2}$ is the coordinate volume of the surfaces parameterized by $%\nx^{i} $. Thus, the free energy of the Ricci flat black hole\nevaluated on the pure AdS background is~\\cite{Euclidean}\n\\begin{eqnarray}\nF &\\equiv &\\frac{I_{E}}{\\beta }=E-TS=-\\frac{ r_{0}^{4}}{16\\pi\nl^{5}}\\eta V_{2}.  \\label{free energy1}\n\\end{eqnarray}\nAnd the energy and entropy are\n\\begin{eqnarray}\nE &=&\\frac{\\partial I_{E}}{\\partial \\beta }=\\frac{3r_{0}^{4}}{16\\pi l^{5}}%\n\\eta V_{2}, \\\\\nS &=&\\beta \\frac{\\partial I_{E}}{\\partial \\beta\n}-I_{E}=\\frac{\\eta V_{2}r_{0}^{3}}{4l^{3}}. \\label{energyandentropy}\n\\end{eqnarray}\nFrom~(\\ref{energyandentropy}), it can be seen that the entropy $S$\nis exactly equal to 1/4 of the horizon area $A$, which implicates\nthat those thermodynamical equations hold\n\\begin{eqnarray}\ndF=-SdT, dE=TdS.  \\label{masslaw1}\n\\end{eqnarray}\nIt should be emphasized that we have not considered the contribution\nof tension term to the laws above, i.e gravitational tension. And it\nis known that the gravitational tension term could contribute to the\nfirst law in the case of the black p-branes or black string if the\nsize of the compact spatial coordinate is allowed to be changed. The\nfact is that the geometry looks locally like the black string when\nis far from the horizon of the Ricci flat black hole, thus the\ngravitational tension term may also contribute to the\nthermodynamical laws~\\cite{Kurita}. And it is true that if assuming\nthe free energy in~(\\ref{free energy1}) is also the function of\n$\\eta $, we can obtain not only the energy and entropy but also the\ngravitational tension\n\\begin{eqnarray}\nE &=&(\\frac{\\partial I_{E}}{\\partial \\beta })_{\\eta }=\\frac{3r_{0}^{4}}{%\n16\\pi l^{5}}\\eta V_{2},  \\notag \\\\\nS &=&\\beta (\\frac{\\partial I_{E}}{\\partial \\beta })_{\\eta\n}-I_{E}=\\frac{\\eta\nV_{2}r_{0}^{3}}{4l^{3}},  \\notag \\\\\n\\Gamma  &=&\\frac{1}{\\beta }(\\frac{\\partial I_{E}}{\\partial \\eta })_{\\beta }=-%\n\\frac{r_{0}^{4}}{16\\pi l^{5}}V_{2}.  \\label{ESTension}\n\\end{eqnarray}\nOn the other hand, in a $d+1$ dimensional spacetime $\\mathcal{M}$,\nthe conserved charge associated with the killing vector $\\xi ^{\\mu\n}$ generating an isometry of the boundary geometry $\\partial\n\\mathcal {M}$ defined through the quasilocal stress tensor\nis~\\cite{Counterterm,Brown}\n\\begin{equation}\nQ_{\\xi }=\\int_{\\Sigma }d^{d-1}x\\sqrt{\\sigma }(u^{\\mu }T_{\\mu \\nu\n}\\xi ^{\\nu }).   \\label{Conservedcharge}\n\\end{equation}%\nwhere $\\Sigma $ is a spacelike hypersurface in the boundary\n$\\partial \\mathcal {M}$, and $u^{\\mu }$ is the timelike unit vector\nnormal to it. $\\sigma _{ab}$ is the metric on $\\Sigma $ defined as\n\\begin{equation}\n\\gamma _{\\mu \\nu }dx^{\\mu }dx^{\\nu }=-N_{\\Sigma }^{2}dt^{2}+\\sigma\n_{ab}(dx^{a}+N_{\\Sigma }^{a}dt)(dx^{b}+N_{\\Sigma }^{b}dt)\n\\label{BoundaryADM}\n\\end{equation}\nand $\\gamma _{\\mu \\nu }$ is the metric on the boundary. Thus, the\nenergy related with the timelike killing vector $\\xi ^{\\mu }$ and\nthe momentum could be defined respectively as\n\\begin{eqnarray}\nE &=&\\int_{\\Sigma }d^{d-1}x\\sqrt{\\sigma }N_{\\Sigma }(u^{\\mu }T_{\\mu\n\\nu\n}u^{\\nu }), \\label{Mass}\n\\\\P_{a} &=&\\int_{\\Sigma }d^{d-1}x\\sqrt{\\sigma }\\sigma _{ab}u_{\\mu\n}T^{b\\mu }.  \\label{Momentum}\n\\end{eqnarray}\nAccording to the surface counterterm method, the quasilocal stress\ntensor for the asymptotically $AdS_{5}$ solution\nis~\\cite{Counterterm}\n\\begin{equation}\nT_{\\mu \\nu }=\\frac{1}{8\\pi }(\\theta _{\\mu \\nu }-\\theta \\gamma _{\\mu \\nu }-%\n\\frac{3}{l}\\gamma _{\\mu \\nu }-G_{\\mu \\nu }).  \\label{stresstensor}\n\\end{equation}%\nwhere all the above tensors refer to the boundary metric $\\gamma\n_{\\mu \\nu }$ defined on the hypersurface $r=constant$, and $G_{\\mu\n\\nu }=R_{\\mu \\nu }-\\frac{1}{2}R\\gamma _{\\mu \\nu }$ is the Einstein\ntensor of $\\gamma _{\\mu \\nu }$, $\\theta _{\\mu \\nu\n}=-\\frac{1}{2}(\\nabla _{\\mu }n_{\\nu }+\\nabla _{v}n_{\\mu })$ is the\nextrinsic curvature of the boundary with the normal vector $n^{\\mu\n}$ in the spacetime. Therefore, we can easily obtain the useful\nquasi-local stress tensor of the Ricci flat black hole~(\\ref{Ricci\nflat black hole})\n\\begin{eqnarray}\n8\\pi T_{tt} &=&\\frac{3r_{0}^{4}}{2l^{3}r^{2}}+...\n\\label{stresstensor1}\n\\end{eqnarray}%\nAnd the energy is\n\\begin{eqnarray}\nE =\\frac{3r_{0}^{4}}{%\n16\\pi l^{5}}\\eta V_{2}. \\label{Energy1}\n\\end{eqnarray}\nwhich is consistent with the above result in~(\\ref{ESTension}). In\naddition, the general definition of gravitational tension in a given\nasymptotically translationally-invariant spatial direction (i.e.\n$x$) of a $D$ dimensional space-time is~\\cite{Tension}\n\\begin{equation}\n\\Gamma =\\frac{1}{\\Delta t}\\frac{1}{8\\pi }\\int_{S_{x}^{\\infty\n}}[F(K^{(D-2)}-K_{0}^{(D-2)})-F^{\\upsilon }p_{\\mu \\nu }r^{\\nu }]\n\\label{TensionDefinition}\n\\end{equation}%\nhere $S_{x}^{\\infty }=\\Sigma _{x}\\cap \\Sigma ^{\\infty }$ and $\\Sigma\n_{x}$ is the hypersurface $x=const$ with unit normal vector $n^{\\mu\n}$, and $\\Sigma ^{\\infty }$ is the asymptotic boundary of the\nspacetime with unit normal vector $r^{\\mu }$. The space-like killing\nvector $X^{\\mu }$ corresponding to the translationally-invariant\nspatial direction $x$ is decomposed into normal and tangential parts\nto $\\Sigma _{x}$ that\n\\begin{equation}\nX^{\\mu }=Fn^{\\mu }+F^{\\mu \\label{Decomposition}}\n\\end{equation}\nand the extrinsic curvature tensor on $\\Sigma _{x}$ with respect to $n^{\\mu }$ is $%\nK_{\\mu \\nu }$, while $K^{(D-2)}$ is the extrinsic curvature of the surface $%\nS_{x}^{\\infty }$ in $\\Sigma _{x}$, and $K_{0}^{(D-2)}$ is the\ncorresponding\nextrinsic curvature of the surface $S_{x}^{\\infty }$ in the reference space $%\n(M,(g_{0})_{\\mu \\nu })$. The metric with respect to $n^{\\mu }$ on\n$\\Sigma _{x}$ is\n\\begin{equation}\nh_{\\mu \\nu }=g_{\\mu \\nu }-n_{\\mu }n_{\\nu \\label{ReducedMetric}}\n\\end{equation}%\nwhile the corresponding canonical momentum $p_{\\mu \\nu }$ with\nrespect to $h_{\\mu \\nu }$ is\n\\begin{equation}\np^{\\mu \\nu }=\\frac{1}{\\sqrt{h}}\\pi ^{\\mu \\nu }=K^{\\mu \\nu }-Kh^{\\mu\n\\nu \\label{CanonicalMomentum}}\n\\end{equation}\nThus, from this general definition of gravitational\ntension~(\\ref{TensionDefinition}), we can obtain the gravitational\ntension along the compact spatial direction $y$ in Ricci flat black\nhole~(\\ref{Ricci flat black hole})\n\\begin{eqnarray}\n\\Gamma  =-\\frac{r_{0}^{4}}{16\\pi l^{5}}V_{2}. \\label{Tension1}\n\\end{eqnarray}\nwhich is also consistent with the above result in~(\\ref{ESTension}).\nAnd these consistences of energy, tension and entropy implicate that\nafter adding the contribution of tension term the first laws\nin~(\\ref{masslaw1}) are\n\\begin{eqnarray}\ndF &=&-SdT+\\Gamma d\\eta =-\\frac{1}{8\\pi }A_{H}d\\kappa _{H}+\\Gamma\nd\\eta ,\n\\notag \\\\\ndE &=&TdS+\\Gamma d\\eta =\\frac{1}{8\\pi }\\kappa _{H}dA_{H}+\\Gamma\nd\\eta . \\label{Masslaw2}\n\\end{eqnarray}\nwhere $T=1/\\beta =\\kappa _{H}/2\\pi $ and $S=A_{H}/4$. Using these\nconserved charges, we can also easily check that\n\\begin{equation}\nE-TS=\\Gamma \\eta.   \\label{Smarr}\n\\end{equation}%\nwhich is very similar with the Smarr relation. Thus\nfrom~(\\ref{Smarr}) and ~(\\ref{Masslaw2}), we can obtain the tension\nlaw that\n\\begin{equation}\n\\eta d\\Gamma =-SdT.  \\label{Tensionlaw1}\n\\end{equation}%\nwhich can be found to have the same formalism with the static\nKaluza-Klein black hole which is asymptotically flat in\nRefs~\\cite{Kastor,Kastor2}.\n\n\\section{The AdS soliton solution, interchange symmetry, and analogy of\nenergy and tension laws}\n\nThe AdS soliton solution is~\\cite{Horowitz}\n\\begin{equation}\nds^{2}=\\frac{r^{2}}{l^{2}}[(1-\\frac{r_{0}^{4}}{r^{4}}%\n)dy^{2}-dt^{2}+(dx^{i})^{2}]+(1-\\frac{r_{0}^{4}}{r^{4}})^{-1}\\frac{l^{2}}{%\nr^{2}}dr^{2}.\\ \\ (i=1,2)  \\label{AdSSoliton}\n\\end{equation}%\nwith the coordinate $r$ restricted to $r\\geq r_{0}$. Again, the\ncoordinate $y $ could be identified with period $\\eta =\\frac{\\pi\nl^{2}}{r_{0}}$ to avoid a conical singularity at $r=r_{0}$. Note\nthat this spacetime is completely nonsingular and globally static.\nAnd it can be obtained from the Ricci flat black hole\nmetric~(\\ref{Ricci flat black hole}) with the double analytic\ncontinuation such that\n\\begin{equation}\nt\\rightarrow iy,y\\rightarrow it.  \\label{Double analytic\ncontinuation}\n\\end{equation}%\nwhich arises an interesting interchange symmetry between the AdS soliton\nsolution and the Ricci flat black hole.\n\nUsing the same surface counterterm method, we can calculate the\nuseful quasilocal stress tension of AdS soliton~\\cite{Counterterm}\n\\begin{eqnarray}\n8\\pi T_{tt} &=&-\\frac{r_{0}^{4}}{2l^{3}r^{2}}+...\n\\label{Stresstension2}\n\\end{eqnarray}%\nThus, the energy is\n\\begin{equation}\nE=-\\frac{r_{0}^{4}}{16\\pi l^{5}}\\eta V_{2}.  \\label{Energy2}\n\\end{equation}%\nIn addition, the tension of the AdS soliton (along the direction of\nthe compact coordinate $y$) from the general\ndefinition~(\\ref{TensionDefinition}) is\n\\begin{equation}\n\\Gamma =\\frac{3r_{0}^{4}}{16\\pi l^{5}%\n} V_{2}.  \\label{Tension2}\n\\end{equation}%\nEqs~(\\ref{Energy2})~(\\ref{Tension2}) can explicitly manifest the\ninterchange symmetry with the Ricci flat black hole compared with\nits energy and tension.\n\nIn the above section, during deriving the laws of Ricci flat black\nhole, we mainly base on an underlying assumption that the\nequations~(\\ref{Masslaw2}) hold, and then find the consistence with\nthe calculations by other methods. However, for the AdS soliton\nsolution, the first problem is these equations may not hold because\nthe period of the imaginary time which usually relates with the\ntemperature is arbitrary in the AdS soliton spacetime. Moreover, if\nwe take the entropy just as the usual Bekenstein-Hawking entropy (it\nis the 1/4 of the horizon area), we could find the entropy is zero.\nThus, the direct analogy of the mass and tension laws of the AdS\nsoliton solution like~(\\ref{Masslaw2})~(\\ref{Tensionlaw1}) seems to\nbe absent. In spite of that, inspired from the interchange symmetry\nbetween the black hole and AdS soliton, it may have the analogy. And\nit is true that it has been found the similar analogy of the KK\nbubble in Ref~\\cite{Kastor} where it discusses the asymptotically\nflat case. As same as that of KK bubble, we can also first define\nsome new quantities, such as the surface gravity and the area of the\nAdS soliton. And according to these definitions, the surface gravity\nand the area of the AdS soliton are~\\cite{Kastor}\n\\begin{equation}\n\\kappa _{s}=\\frac{2r_{0}}{l^{2}},A_{s}=\\frac{V_{2}r_{0}^{3}}{l^{3}}.\n\\label{SurfacegravityandArea}\n\\end{equation}%\nHowever, here we would not use the Hamiltonian perturbation\ntechniques to deduce the laws of AdS soliton until one finds its\nappropriate formalisms of the conserved charges and gravitational\ntension as those of KK bubble. And we just base on its interchange\nsymmetry with the Ricci flat black hole~(\\ref{Ricci flat black\nhole}). From the quantities in~(\\ref{SurfacegravityandArea}) and\nthose in ~(\\ref{Energy2})~(\\ref{Tension2}), we can make an easy\ndisplacement in~(\\ref{Masslaw2})~(\\ref{Smarr}) and\n~(\\ref{Tensionlaw1}) by using the interchange symmetry such that\n\\begin{equation}\nE\\rightarrow \\Gamma \\eta ,T\\rightarrow T,S\\rightarrow S\\eta ,\\Gamma\n\\rightarrow E/\\eta.  \\label{displacement}\n\\end{equation}\nThus we can obtain the reduced relations\n\\begin{equation}\nd\\Gamma =\\frac{1}{8\\pi G}\\kappa _{s}dA_{s}.  \\label{MassTesionlaw3}\n\\end{equation}\n\\begin{equation}\ndE=-\\frac{1}{8\\pi G}\\eta A_{s}d\\kappa _{s}+(\\Gamma -\\frac{1}{8\\pi\nG}\\kappa _{s}A_{s})d\\eta .  \\label{12}\n\\end{equation}%\nFrom which, we can easily check out that they hold by using the\nquantities\nin~(\\ref{Energy2})~(\\ref{Tension2})~(\\ref{SurfacegravityandArea})\nand see that they have the similar formalisms with the laws of black\nhole. Thus they can be naturally considered as the analogy of the\nenergy and tension laws of the AdS soliton. The most interesting\nthing is that they has the same formalism with the result of the K-K\nbubble in Ref~\\cite{Kastor} where it is deduced by using the\nHamiltonian perturbation theory\ntechniques~\\cite{Traschen,Perturbation technique}. Thus, it is more\nconvincible that they could be considered as the analogy of the\nenergy and tension laws of the AdS soliton.\n\n\\section{The energy and tension laws for boosted Ricci flat black hole}\n\nThe boosted Ricci flat black hole can be obtained from~(\\ref{Ricci\nflat black hole}) by the following boost transformation~\\cite{Cai2}\n\\begin{eqnarray}\nt &\\rightarrow &t\\cosh \\alpha -y\\sinh \\alpha ,  \\nonumber \\\\\ny &\\rightarrow &-t\\sinh \\alpha +y\\cosh \\alpha .  \\label{Boost\ntransformation}\n\\end{eqnarray}%\nwhere $\\alpha $ is the boost parameter and the boost velocity is\n$v=\\tanh \\alpha $. Thus, the metric of the boosted Ricci flat black\nhole is\n\\begin{equation}\nds^{2}=\\frac{r^{2}}{l^{2}}[-dt^{2}+dy^{2}+\\frac{r_{0}^{4}}{r^{4}}(dt\\cosh\n\\alpha -dy\\sinh \\alpha )^{2}+(dx^{i})^{2}]+(1-\\frac{r_{0}^{4}}{r^{4}})^{-1}%\n\\frac{l^{2}}{r^{2}}dr^{2}.\\ \\ (i=1,2)  \\label{Boosted Ricci flat\nblack hole}\n\\end{equation}%\nNote that, because the coordinate $y$ in~(\\ref{Boost\ntransformation}) is periodic, the solution~(\\ref{Boosted Ricci flat\nblack hole}) is not equivalent to the static Ricci flat black\nhole~(\\ref{Ricci flat black hole}) globally~\\cite{Lemos,Awad,Cai2}.\nAnd in order to remove the conical singularity at the horizon\n$r=r_{0}$, the Euclidean time $\\tau $ in~(\\ref{Boosted Ricci flat\nblack hole}) could have a period $\\beta =\\frac{\\pi l^{2}\\cosh \\alpha\n}{r_{0}}$. Following the same procedure as section II, at first we\ndo not consider the contribution from the gravitational tension term\nin the laws of thermodynamics. After choosing the pure AdS spacetime\nas the background and using the same Euclidean method, we can obtain\nthe Euclidean action of the boosted Ricci black hole to\nbe~\\cite{Euclidean}\n\\begin{equation}\nI_{E}=-\\frac{\\beta r_{0}^{4}}{16\\pi Gl^{5}}\\eta V_{2}.\n\\label{Euclidean action2}\n\\end{equation}\nNote that, although the Euclidean action is the same as that of the\nstatic Ricci flat black hole~(\\ref{Euclidean action1}), the\nrelationship between $\\beta$ and $r_{0}$ is different. Moreover,\nhere the thermal function related with Euclidean action is the\nGibbons free energy~\\cite{Euclidean}\n\\begin{eqnarray}\nG &\\equiv &\\frac{I_{E}}{\\beta }=E-TS-vP.  \\label{Gibbons Free\nenergy}\n\\end{eqnarray}\nand $G$ is the function of not only $\\beta$ but also the boost\nvelocity $v$.  Thus, the energy, entropy and momentum are\n\\begin{eqnarray}\nE &=&(\\frac{\\partial I_{E}}{\\partial \\beta })_{v}-\\frac{v}{\\beta }(\\frac{%\n\\partial I_{E}}{\\partial v})_{\\beta }=\\frac{(3+4a^{2})r_{0}^{4}}{16\\pi l^{5}}%\n\\eta V_{2},  \\notag \\\\\nS &=&\\beta (\\frac{\\partial I_{E}}{\\partial \\beta\n})_{v}-I_{E}=\\frac{\\eta\nV_{2}r_{0}^{3}}{4l^{3}}\\sqrt{1+a^{2}},  \\notag \\\\\nP &=&-\\frac{1}{\\beta }(\\frac{\\partial I_{E}}{\\partial v})_{\\beta }=\\frac{%\n\\eta V_{2}r_{0}^{4}}{4\\pi l^{5}}a\\sqrt{1+a^{2}}.\n\\label{EnergyEntropyMomentum}\n\\end{eqnarray}\nwhere $a\\equiv \\sinh \\alpha $ and it could be easily seen that the\nentropy $S$ is also exactly equal to 1/4 of the horizon area $A$,\nwhich implicates that the following relations hold\n\\begin{eqnarray}\ndG &=&-SdT-Pdv,  \\notag \\\\\ndE &=&TdS+vdP.  \\label{Masslaw3}\n\\end{eqnarray}\nAgain if assuming the Gibbons free energy $G$ in~(\\ref{Gibbons Free\nenergy}) is also the function of $\\eta $, we can also obtain the\ngravitational tension\n\\begin{eqnarray}\nE &=&(\\frac{\\partial I_{E}}{\\partial \\beta })_{v,\\eta }-\\frac{v}{\\beta }(%\n\\frac{\\partial I_{E}}{\\partial v})_{\\beta ,\\eta }=\\frac{(3+4a^{2})r_{0}^{4}}{%\n16\\pi l^{5}}\\eta V_{2},  \\notag \\\\\nS &=&\\beta (\\frac{\\partial I_{E}}{\\partial \\beta })_{v,\\eta }-I_{E}=\\frac{%\n\\eta V_{2}r_{0}^{3}}{4l^{3}}\\sqrt{1+a^{2}},  \\notag \\\\\nP &=&-\\frac{1}{\\beta }(\\frac{\\partial I_{E}}{\\partial v})_{\\beta ,\\eta }=%\n\\frac{\\eta V_{2}r_{0}^{4}}{4\\pi l^{5}}a\\sqrt{1+a^{2}},  \\notag \\\\\n\\Gamma  &=&\\frac{1}{\\beta }(\\frac{\\partial I_{E}}{\\partial \\eta\n})_{\\beta ,v}=-\\frac{r_{0}^{4}}{16\\pi l^{5}}V_{2}. \\label{ESP2}\n\\end{eqnarray}\nOn the other hand, according to the definition, the useful\nquasi-local stress tensor of the boosted Ricci flat black\nhole~(\\ref{Boosted Ricci flat black hole}) is~\\cite{Counterterm}\n\\begin{eqnarray}\n8\\pi T_{tt} &=&\\frac{(3+4\\sinh ^{2}\\alpha\n)r_{0}^{4}}{2l^{3}r^{2}}+...\n\\nonumber \\\\\n8\\pi T_{ty} &=&-\\frac{2\\sinh \\alpha \\cosh \\alpha\nr_{0}^{4}}{l^{3}r^{2}}+... \\label{StressTensor2}\n\\end{eqnarray}%\nFrom which the energy and momentum can be calculated to be\n\\begin{eqnarray}\nE &=&\\frac{(3+4\\sinh ^{2}\\alpha )r_{0}^{4}}{16\\pi l^{5}}\\eta V_{2},\n\\nonumber \\\\\nP &=&\\frac{\\sinh \\alpha \\cosh \\alpha r_{0}^{4}}{4\\pi l^{5}}\\eta\nV_{2}. \\label{MPTension}\n\\end{eqnarray}\nwhere the energy and momentum are consistent with the above results\nin~(\\ref{ESP2}). And this consistence could implicate that after\nadding the contribution of tension term the first laws\nin~(\\ref{Masslaw3}) are\n\\begin{eqnarray}\ndG &=&-SdT-Pdv+\\Gamma d\\eta ,  \\notag \\\\\ndE &=&TdS+vdP+\\Gamma d\\eta .  \\label{Masslaw4}\n\\end{eqnarray}\nHowever, if we use the general definition of gravitational\ntension~(\\ref{TensionDefinition}), we can obtain the tension\n\\begin{equation}\n\\Gamma^{'} =-\\frac{(1+4\\sinh ^{2}\\alpha )r_{0}^{4}}{16\\pi\nl^{5}}V_{2}. \\label{Tension3}\n\\end{equation}\nwhich is not consistent with the result in~(\\ref{ESP2}). Note that,\nthis difference has also been found by D. Kastor et al, and they\nargued that the tension obtained in~(\\ref{ESP2}) was in fact an\neffective tension which was related to the general tension such\nthat~\\cite{Kastor2}\n\\begin{equation}\n\\Gamma =\\Gamma^{'} +\\frac{vP}{\\eta }.  \\label{TTRelation}\n\\end{equation}%\nFrom which, we can also find that when the boosted velocity is zero,\nthe general tension is just equal to the effective tension.\n\nUsing these quantities in ~(\\ref{ESP2})~(\\ref{MPTension}), we can\nalso check that\n\\begin{equation}\nE-TS-vP=\\Gamma \\eta   \\label{Smarr2}\n\\end{equation}\nThus, from this relation~(\\ref{Smarr2}) and the first energy\nlaw~(\\ref{Masslaw4}), the first tension law of boosted Ricci flat\nblack hole is\n\\begin{equation}\nSdT+Pdv+\\eta d\\Gamma =0  \\label{Tensionlaw2}\n\\end{equation}\n\n\n\\section{The boosted AdS soliton solution}\nNaturally, we can also make a boost transformation~(\\ref{Boost\ntransformation}) along the compact coordinate $y$ in the static AdS\nsoliton solution~(\\ref{AdSSoliton}). Thus, the boosted AdS soliton\nsolution is\n\\begin{equation}\nds^{2}=\\frac{r^{2}}{l^{2}}[-dt^{2}+dy^{2}-\\frac{r_{0}^{4}}{r^{4}}(dy\\cosh\n\\alpha -dt\\sinh \\alpha )^{2}+(dx^{i})^{2}]+(1-\\frac{r_{0}^{4}}{r^{4}})^{-1}%\n\\frac{l^{2}}{r^{2}}dr^{2}.\\ \\ (i=1,2)  \\label{BoostedAdSSoliton}\n\\end{equation}\nNote that this solution is also different from the static AdS\nsoliton globally, and it is easy to see that the coordinate $y$ in\nthe boost transformation is compact. In addition, an interesting\nresult is that this boosted AdS soliton solution also has the same\ninterchange symmetry with the boosted Ricci flat black hole. That\nis, it can also be obtained from the boosted Ricci flat black hole\nsolution by the double analytic continuation between the time and\nthe compact coordinate $y$ in~(\\ref{Boosted Ricci flat black hole}).\nIn the above section we have obtained the analogy of the energy and\ntension laws of the static AdS soliton solution through the\ninspiration from the interchange symmetry with the Ricci flat black\nhole. However, it's easily found that there are closed timelike\ncurves in the boosted AdS soliton\nsolution~(\\ref{BoostedAdSSoliton}). Moreover, viewed from the\nphysical point, after boosting along the compact coordinate $y$ in\nstatic AdS soliton~(\\ref{AdSSoliton}), the period of $y$ would be\nshrunk to $\\gamma ^{-1}\\eta $ where $\\gamma =(1-v^{2})^{-1/2}=\\cosh\n\\alpha $ is the shrinking factor. However, the new period could not\navoid the conical singularity. Thus, this boosted AdS soliton\nsolution is ill in physics and the direct analogy of laws is of no\nsense. In spite of that, the conserved charges such as energy and\nmomentum are well defined because they just depend on the properties\nof its asymptotic behavior. And the corresponding quasi-local stress\ntensor of the boosted AdS soliton solution can be\nobtained~\\cite{Counterterm}\n\\begin{eqnarray}\n8\\pi T_{tt} &=&-\\frac{(1+4\\sinh ^{2}\\alpha\n)r_{0}^{4}}{2l^{3}r^{2}}+...\n\\nonumber \\\\\n8\\pi T_{ty} &=&\\frac{2\\sinh \\alpha \\cosh \\alpha\nr_{0}^{4}}{l^{3}r^{2}}+... \\label{StressTensor4}\n\\end{eqnarray}%\nThus, the energy and momentum of the boosted AdS soliton solution\nare\n\\begin{eqnarray}\nE &=&-\\frac{(1+4\\sinh ^{2}\\alpha )r_{0}^{4}}{16\\pi l^{5}}\\eta V_{2},\n\\nonumber \\\\\nP &=&-\\frac{\\sinh \\alpha \\cosh \\alpha r_{0}^{4}}{4\\pi l^{5}}\\eta\nV_{2}. \\label{EP4}\n\\end{eqnarray}%\nIn addition, the general tension can also be obtained from the\ndefinition~(\\ref{TensionDefinition})\n\\begin{equation}\n\\Gamma =\\frac{(3+4\\sinh ^{2}\\alpha )r_{0}^{4}}{16\\pi l^{5}}V_{2}.\n\\label{T4}\n\\end{equation}%\nThese quantities in~(\\ref{EP4})~(\\ref{T4}) could explicitly manifest\nthe interchange symmetry with the boosted Ricci flat black hole,\ntoo.\n\n\n\n\\section{Conclusion and discussion}\n\nOne of the motivations of this paper is to obtain the analogy of the\nenergy and tension laws of the AdS soliton solution, which can give\nmore understanding of this solution. In order to obtain them, we\nfirst reconsider the laws of the Ricci flat black hole by taking the\ncontribution of the tension term into account. Then, inspired from\nthe interchange symmetry between the Ricci flat black hole and AdS\nsoliton, we finally obtain the analogy. In spite of that, how to\nunderstand the analogy of laws of the AdS soliton is an open\nquestion. Particularly, whether there is some underlying physical\ninterpretations such as thermodynamical effects in it is worthy of\nfurther discussion. In addition, as a more general asymptotically\nAdS black hole solution, we also take the boosted Ricci flat black\nhole for example to give a simple generalization of the works by\nD.Kastor to the asymptotically AdS case. Note that, although here\nour formalisms of the laws of black holes or the static soliton are\nthe same as those of the asymptotically flat cases, the underlying\ndeduced contents are different. In principle, if we find the\nappropriate formalisms of conserved charges and gravitational\ntension, we perhaps can also use the Hamiltonian perturbation method\nto deduce these laws directly. And this possibility will be\nconsidered in the future work. As the corresponding solution which\nhas the interchange symmetry with boosted Ricci flat black hole, we\nalso consider the boosted AdS soliton solution. However, although\nthere is the same interchange symmetry, this boosted AdS soliton\nsolution is ill in physics because of the existence of the closed\ntimelike curves and conical singularity. Thus, the direct analogy of\nenergy and tension laws are of no sense. In spite of that, an\ninteresting result is that the conserved charges such as the energy\nand momentum are well-defined for the boosted AdS soliton solution.\nMoreover, as we expected, its energy is smaller than that of the\nstatic AdS soliton solution. Thus, whether it can be considered as a\nviolation case to the new positive energy conjecture proposed by G.T\nHorowitz and R.C Myers and how to understand it from the viewpoint\nof the AdS/CFT correspondence would also be interesting things to\ngive further discussions. In addition, during calculating the\nconserved charges, we also find that perhaps there is a new way to\ndefine the gravitational tension from the quasi-local stress tensor\ndefined in~(\\ref{stresstensor}), because the gravitational tension\ncan be easily found to be related to the corresponding stress tensor\n$T_{yy}$ such that\n\\begin{eqnarray}\n\\text{Ricci flat black hole} &\\text{: }&\\Gamma =-\\frac{r_{0}^{4}}{16\\pi l^{5}%\n}V_{2},\\text{ }T_{yy}=\\frac{r_{0}^{4}}{16\\pi l^{3}r^{2}}+....\\text{\\\n}\n\\notag \\\\\n\\text{Static AdS soliton} &\\text{:}&\\Gamma =\\frac{3r_{0}^{4}}{16\\pi l^{5}}%\nV_{2},\\text{ }T_{yy}=-\\frac{3r_{0}^{4}}{16\\pi\nl^{3}r^{2}}+....\\text{\\ }\n\\notag \\\\\n\\text{Boosted Ricci flat black hole} &\\text{:}&\\Gamma =-\\frac{%\n(1+4a^{2})r_{0}^{4}}{16\\pi l^{5}}V_{2},\\text{ }T_{yy}=\\frac{%\n(1+4a^{2})r_{0}^{4}}{16\\pi l^{3}r^{2}}+....  \\notag \\\\\n\\text{Boosted AdS soliton} &\\text{:}&\\Gamma =\\frac{3r_{0}^{4}}{16\\pi l^{5}}%\nV_{2},\\text{ }T_{yy}=-\\frac{(3+4a^{2})r_{0}^{4}}{16\\pi\nl^{3}r^{2}}+.... \\label{TTYYRelation}\n\\end{eqnarray}\nOn the other hand, viewed from the physical interpretation of the\nstress tensor, its spatial diagonal components are related with the\npressure, thus it is more convincible that there is a new\npossibility to define the gravitational tension. In fact,\nconsidering the interchange symmetry and the formalisms\nin~(\\ref{Mass})~(\\ref{TensionDefinition}), we can give the new\ndefinition of the gravitational tension through the counterterm in\nthe asymptotical AdS case that\n\\begin{equation}\n\\Gamma =-\\frac{1}{\\Delta t}\\int_{S_{x}^{\\infty }}d^{d-1}x\\sqrt{\\sigma }%\nF(n^{\\mu }T_{\\mu \\nu }n^{\\nu })  \\label{TensionNewDefinition}\n\\end{equation}\nwhich can be easily checked that this new definition is satisfied in\nour cases.\n\nNote that, after our paper appeared, Dr. Cristian Stelea showed me\nthat they had also already given an exact formalism of the\ngravitational tension through the counterterm in their cases. Thus\ngiving a more general rigorous definition of the gravitational\ntension through the counterterm is an open interesting question, and\nperhaps some clues could be found in their works~\\cite{Stelea}.\n\n\n\\section{Acknowledgements}\n\nY.P Hu thanks Professor Rong-Gen Cai and Dr.Li-Ming Cao, Jia-Rui\nSun, Xue-Fei Gong and Chang-Yong Liu for their helpful discussions.\nAnd Y.P Hu also thanks Dr. Cristian Stelea for his useful\ninformation. This work is supported partially by grants from NSFC,\nChina (No. 10325525, No. 90403029 and No. 10773002), and a grant\nfrom the Chinese Academy of Sciences.\n\n", 'meta': {'timestamp': datetime.datetime(2009, 5, 21, 6, 38, 16), 'yymm': '0904', 'arxiv_id': '0904.1250', 'language': 'en', 'url': 'https://arxiv.org/abs/0904.1250'}} or rewrite tokenize_example in data.py 
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-31 16:00:10,718] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
=======================================================================
I1231 16:00:10.720147 88144 tcp_utils.cc:181] The server starts to listen on IP_ANY:58758
I1231 16:00:10.720319 88144 tcp_utils.cc:130] Successfully connected to 10.3.242.26:58758
I1231 16:00:13.783499 88144 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:00:13.783568 88144 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:00:13,784] [    INFO] topology.py:370 - Total 4 pipe comm group(s) create successfully!
W1231 16:00:13.824368 88144 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:00:13.826789 88144 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-31 16:00:15,677] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:00:15,677] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
I1231 16:00:15.678014 88144 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:00:15.678042 88144 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:00:15,678] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1231 16:00:15.678141 88144 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:00:15.678146 88144 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:00:15,678] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 4, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:00:15,678] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:00:15,679] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:00:15,679] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:00:15,680] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - [0m
[35m[2024-12-31 16:00:15,681] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - [0m
[35m[2024-12-31 16:00:15,682] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:00:15,683] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:00:15,683] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:00:15,683] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:00:15,683] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:00:15,683] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:00:15,683] [   DEBUG][0m - [0m
[32m[2024-12-31 16:00:15,684] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:00:15,684] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:00:15,685] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:00:15,687] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:00:15,688] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling.LlamaForCausalLM'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:00:15,689] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:01:38,924] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[32m[2024-12-31 16:02:43,031] [    INFO][0m - All model checkpoint weights were used when initializing LlamaForCausalLM.
[0m
[32m[2024-12-31 16:02:43,031] [    INFO][0m - All the weights of LlamaForCausalLM were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.[0m
[32m[2024-12-31 16:02:43,033] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/generation_config.json[0m
[32m[2024-12-31 16:02:44,705] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:02:44,766] [   DEBUG][0m - Frozen parameters: 6.74e+09 || Trainable parameters:2.00e+07 || Total parameters:6.76e+09|| Trainable:0.30%[0m
[35m[2024-12-31 16:02:44,766] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:02:46,212] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:02:46,339] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:02:46,459] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:02:46,459] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:02:46,459] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:02:46,459] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:02:46,460] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:02:46,461] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - dataset_world_size            : 4[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:02:46,462] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - eval_batch_size               : 8[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:02:46,463] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:02:46,464] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-00-10_ubuntu[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:02:46,465] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:02:46,466] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - optimizer_name_suffix         : shard00[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - per_device_eval_batch_size    : 8[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - per_device_train_batch_size   : 4[0m
[35m[2024-12-31 16:02:46,467] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - pipeline_parallel_degree      : 1[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:02:46,468] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:02:46,469] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding                      : [<ShardingOption.SHARD_OP: 'stage1'>][0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding_parallel_degree      : 4[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:02:46,470] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - train_batch_size              : 4[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:02:46,471] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:02:46,472] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:02:46,473] [   DEBUG][0m - weight_name_suffix            : [0m
[35m[2024-12-31 16:02:46,473] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:02:46,473] [   DEBUG][0m - [0m
[32m[2024-12-31 16:02:46,475] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:02:46,477] [    INFO] sharding_parallel.py:30 - start broadcast sharding parameters
[2024-12-31 16:02:47,258] [    INFO] sharding_parallel.py:37 - sharding's parameters is ready
[2024-12-31 16:02:47,258] [    INFO] dygraph_sharding_optimizer.py:71 - init DygraphShardingOptimizer
[2024-12-31 16:02:47,263] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:02:47,866] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:02:47) [0m
[32m[2024-12-31 16:02:47,866] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:02:47,866] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:02:47,866] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:02:47,866] [    INFO][0m -   Instantaneous batch size per device = 4[0m
[32m[2024-12-31 16:02:47,867] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 64[0m
[32m[2024-12-31 16:02:47,867] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:02:47,867] [    INFO][0m -   Total optimization steps = 23[0m
[32m[2024-12-31 16:02:47,867] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:02:47,870] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (per device)[0m
Exception in thread Thread-3 (_thread_loop):
Traceback (most recent call last):
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 245, in _thread_loop
    batch = self._dataset_fetcher.fetch(
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
  File "/home/sjx/tr-paddle-1230/paddlenlp/datasets/dataset.py", line 266, in __getitem__
    return self._transform(self.new_data[idx]) if self._transform_pipline else self.new_data[idx]
  File "/home/sjx/tr-paddle-1230/paddlenlp/datasets/dataset.py", line 258, in _transform
    data = fn(data)
  File "/home/sjx/tr-paddle-1230/llm/utils/data.py", line 204, in convert_example_common
    tokenized_source = tokenize_unsupervised_example(
  File "/home/sjx/tr-paddle-1230/llm/utils/data.py", line 85, in tokenize_unsupervised_example
    max_length=data_args.scaled_max_length,
AttributeError: 'DataConfig' object has no attribute 'scaled_max_length'. Did you mean: 'pad_to_max_length'?
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[2024-12-31 16:04:53,625] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
=======================================================================
I1231 16:04:53.626557 96372 tcp_utils.cc:181] The server starts to listen on IP_ANY:54723
I1231 16:04:53.626713 96372 tcp_utils.cc:130] Successfully connected to 10.3.242.26:54723
I1231 16:04:56.783484 96372 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:04:56.783572 96372 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:04:56,784] [    INFO] topology.py:370 - Total 4 pipe comm group(s) create successfully!
W1231 16:04:56.813505 96372 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:04:56.816036 96372 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/communication/group.py:128: UserWarning: Current global rank 0 is not in group _default_pg10
  warnings.warn(
[2024-12-31 16:04:58,866] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:04:58,866] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
I1231 16:04:58.866489 96372 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:04:58.866515 96372 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:04:58,866] [    INFO] topology.py:370 - Total 1 sharding comm group(s) create successfully!
I1231 16:04:58.866597 96372 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:04:58.866602 96372 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:04:58,866] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 4, pp_degree: 1, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0, 1, 2, 3], pp_group: [0], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:04:58,866] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:04:58,867] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:04:58,867] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:04:58,868] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - [0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:04:58,869] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - [0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:04:58,870] [   DEBUG][0m - [0m
[32m[2024-12-31 16:04:58,871] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:04:58,872] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:04:58,873] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:04:58,874] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:04:58,875] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling.LlamaForCausalLM'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:04:58,876] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:06:10,118] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[32m[2024-12-31 16:07:21,303] [    INFO][0m - All model checkpoint weights were used when initializing LlamaForCausalLM.
[0m
[32m[2024-12-31 16:07:21,304] [    INFO][0m - All the weights of LlamaForCausalLM were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLM for predictions without further training.[0m
[32m[2024-12-31 16:07:21,306] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/generation_config.json[0m
[32m[2024-12-31 16:07:23,216] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:07:23,300] [   DEBUG][0m - Frozen parameters: 6.74e+09 || Trainable parameters:2.00e+07 || Total parameters:6.76e+09|| Trainable:0.30%[0m
[35m[2024-12-31 16:07:23,301] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:07:26,417] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:07:26,563] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:07:26,655] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:07:26,656] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - dataset_world_size            : 4[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - eval_batch_size               : 8[0m
[35m[2024-12-31 16:07:26,657] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:07:26,658] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-04-53_ubuntu[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:07:26,659] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - optimizer_name_suffix         : shard00[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - per_device_eval_batch_size    : 8[0m
[35m[2024-12-31 16:07:26,660] [   DEBUG][0m - per_device_train_batch_size   : 4[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - pipeline_parallel_degree      : 1[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:07:26,661] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding                      : [<ShardingOption.SHARD_OP: 'stage1'>][0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding_parallel_degree      : 4[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:07:26,662] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - train_batch_size              : 4[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:07:26,663] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - weight_name_suffix            : [0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:07:26,664] [   DEBUG][0m - [0m
[32m[2024-12-31 16:07:26,666] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:07:26,668] [    INFO] sharding_parallel.py:30 - start broadcast sharding parameters
[2024-12-31 16:07:27,452] [    INFO] sharding_parallel.py:37 - sharding's parameters is ready
[2024-12-31 16:07:27,453] [    INFO] dygraph_sharding_optimizer.py:71 - init DygraphShardingOptimizer
[2024-12-31 16:07:27,454] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:07:28,065] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:07:28) [0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Instantaneous batch size per device = 4[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 64[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Total optimization steps = 23[0m
[32m[2024-12-31 16:07:28,065] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:07:28,070] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (per device)[0m
/home/sjx/tr-paddle-1230/paddlenlp/transformers/tokenizer_utils_base.py:2097: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
Traceback (most recent call last):
  File "/home/sjx/tr-paddle-1230/llm/run_finetune.py", line 679, in <module>
    main()
  File "/home/sjx/tr-paddle-1230/llm/run_finetune.py", line 419, in main
    train_result = trainer.train(resume_from_checkpoint=checkpoint)
  File "/home/sjx/tr-paddle-1230/paddlenlp/trainer/trainer.py", line 876, in train
    return self._inner_training_loop(
  File "/home/sjx/tr-paddle-1230/paddlenlp/trainer/trainer.py", line 1114, in _inner_training_loop
    tr_loss_step = self.training_step(model, inputs, step_control=step_control)
  File "/home/sjx/tr-paddle-1230/paddlenlp/trainer/trainer.py", line 2360, in training_step
    loss = self.compute_loss(model, inputs)
  File "/home/sjx/tr-paddle-1230/paddlenlp/trainer/trainer.py", line 2300, in compute_loss
    outputs = model(**inputs)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1532, in __call__
    return self.forward(*inputs, **kwargs)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/distributed/fleet/meta_parallel/meta_parallel_base.py", line 37, in forward
    output = self._layers(*inputs, **kwargs)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1532, in __call__
    return self.forward(*inputs, **kwargs)
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/llama/modeling.py", line 2101, in forward
    outputs = self.llama(
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/nn/layer/layers.py", line 1532, in __call__
    return self.forward(*inputs, **kwargs)
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/llama/modeling.py", line 1741, in forward
    attention_mask = self._prepare_decoder_attention_mask(
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/llama/modeling.py", line 1607, in _prepare_decoder_attention_mask
    expanded_attn_mask = paddle.where(expanded_attn_mask.cast("bool"), 0.0, paddle.finfo(dtype).min)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/tensor/search.py", line 786, in where
    cast_cond = paddle.cast(condition, x.dtype)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/tensor/manipulation.py", line 237, in cast
    return _C_ops.cast(x, dtype)
MemoryError: 

--------------------------------------
C++ Traceback (most recent call last):
--------------------------------------
0   paddle::pybind::eager_api_cast(_object*, _object*, _object*)
1   cast_ad_func(paddle::Tensor const&, phi::DataType)
2   paddle::experimental::cast(paddle::Tensor const&, phi::DataType)
3   void phi::CastKernel<bool, phi::GPUContext>(phi::GPUContext const&, phi::DenseTensor const&, phi::DataType, phi::DenseTensor*)
4   void phi::CastCUDAKernelImpl<bool, double>(phi::GPUContext const&, phi::DenseTensor const&, phi::DataType, phi::DenseTensor*)
5   double* phi::DeviceContext::Alloc<double>(phi::TensorBase*, unsigned long, bool) const
6   phi::DeviceContext::Impl::Alloc(phi::TensorBase*, phi::Place const&, phi::DataType, unsigned long, bool, bool) const
7   phi::DenseTensor::AllocateFrom(phi::Allocator*, phi::DataType, unsigned long, bool)
8   paddle::memory::allocation::Allocator::Allocate(unsigned long)
9   paddle::memory::allocation::StatAllocator::AllocateImpl(unsigned long)
10  paddle::memory::allocation::Allocator::Allocate(unsigned long)
11  paddle::memory::allocation::Allocator::Allocate(unsigned long)
12  paddle::memory::allocation::Allocator::Allocate(unsigned long)
13  paddle::memory::allocation::Allocator::Allocate(unsigned long)
14  paddle::memory::allocation::CUDAAllocator::AllocateImpl(unsigned long)
15  std::string phi::enforce::GetCompleteTraceBackString<std::string >(std::string&&, char const*, int)
16  common::enforce::GetCurrentTraceBackString[abi:cxx11](bool)

----------------------
Error Message Summary:
----------------------
ResourceExhaustedError: 

Out of memory error on GPU 0. Cannot allocate 41.110929GB memory on GPU 0, 72.475098GB memory has been allocated and available memory is only 6.675903GB.

Please check whether there is any other process using GPU 0.
1. If yes, please stop them, or start PaddlePaddle on another GPU.
2. If no, please decrease the batch size of your model. 
 (at ../paddle/phi/core/memory/allocation/cuda_allocator.cc:84)

/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[33m[2024-12-31 16:14:26,279] [ WARNING][0m - sharding_parallel_degree=1 means no sharding, please set sharding to empty![0m
[2024-12-31 16:14:26,279] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
[32m[2024-12-31 16:14:26,279] [    INFO][0m - PP configs:{'micro_batch_size': 1, 'accumulate_steps': 4, 'schedule_mode': '1F1B', 'p2p_cache_shape': True, 'enable_partial_send_recv': True}, use master_grad: False[0m
[33m[2024-12-31 16:14:26,279] [ WARNING][0m - In pipeline model, the evaluation also shares same setting with training. We will enforce that per_device_eval_batch_size=per_device_train_batch_size * gradient_accumulation_steps.[0m
[32m[2024-12-31 16:14:26,279] [    INFO][0m - using pipeline configs:{'delay_scale_loss': False, 'dp_comm_overlap': False, 'sharding_comm_overlap': False, 'enable_timer': False, 'release_gradients': False, 'overlap_p2p_comm': False, 'clear_every_step_cache': False, 'use_batch_p2p_comm': True, 'best_unbalanced_scheduler': False}[0m
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
=======================================================================
I1231 16:14:26.280810 112003 tcp_utils.cc:181] The server starts to listen on IP_ANY:55726
I1231 16:14:26.280987 112003 tcp_utils.cc:130] Successfully connected to 10.3.242.26:55726
I1231 16:14:26.463300 112003 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:14:26.463325 112003 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:14:26.463696 112003 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:14:26.463728 112003 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:14:26,463] [    INFO] topology.py:370 - Total 1 pipe comm group(s) create successfully!
W1231 16:14:26.478889 112003 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:14:26.481261 112003 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
[2024-12-31 16:14:29,187] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:14:29,188] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
[2024-12-31 16:14:29,188] [    INFO] topology.py:370 - Total 4 sharding comm group(s) create successfully!
I1231 16:14:29.188405 112003 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:14:29.188427 112003 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:14:29.188486 112003 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:14:29.188493 112003 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:14:29,188] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 1, pp_degree: 4, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0], pp_group: [0, 1, 2, 3], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:14:29,188] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:14:29,189] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:14:29,190] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:14:29,191] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:14:29,192] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - [0m
[35m[2024-12-31 16:14:29,193] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:14:29,194] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - [0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:14:29,195] [   DEBUG][0m - [0m
[32m[2024-12-31 16:14:29,197] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:14:29,197] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:14:29,198] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:14:29,201] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pipeline_parallel_degree": 4,
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:14:29,201] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling_pp.LlamaForCausalLMPipe'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:14:29,202] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:15:51,602] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:609 - start segment network..
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:615 - segment with method: layer:LlamaDecoderLayer; result: 0, 9, 17, 25, 35
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:631 - stage=0, global_rank=0 ,layer_number=9
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 0: LlamaEmbeddingPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 1: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 2: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 3: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 4: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 5: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 6: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 7: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 8: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:631 - stage=1, global_rank=0 ,layer_number=8
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 9: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 10: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 11: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 12: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 13: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 14: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 15: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 16: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:631 - stage=2, global_rank=0 ,layer_number=8
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 17: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 18: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 19: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 20: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 21: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 22: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 23: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 24: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:631 - stage=3, global_rank=0 ,layer_number=10
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 25: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,610] [    INFO] pp_layers.py:636 - 26: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 27: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 28: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 29: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 30: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 31: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 32: LlamaDecoderLayerPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 33: LlamaRMSNormPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:636 - 34: LlamaLMHeadPipe
[2024-12-31 16:15:51,611] [    INFO] pp_layers.py:658 - loss: LlamaPretrainingCriterion
[2024-12-31 16:15:51,703] [    INFO] pp_layers.py:708 - flush 9 of layers into run_function
[33m[2024-12-31 16:16:12,164] [ WARNING][0m - Some weights of the model checkpoint at meta-llama/Llama-2-7b were not used when initializing LlamaForCausalLMPipe: ['llama.layers.10.input_layernorm.weight', 'llama.layers.10.mlp.down_proj.weight', 'llama.layers.10.mlp.gate_proj.weight', 'llama.layers.10.mlp.up_proj.weight', 'llama.layers.10.post_attention_layernorm.weight', 'llama.layers.10.self_attn.k_proj.weight', 'llama.layers.10.self_attn.o_proj.weight', 'llama.layers.10.self_attn.q_proj.weight', 'llama.layers.10.self_attn.v_proj.weight', 'llama.layers.11.input_layernorm.weight', 'llama.layers.11.mlp.down_proj.weight', 'llama.layers.11.mlp.gate_proj.weight', 'llama.layers.11.mlp.up_proj.weight', 'llama.layers.11.post_attention_layernorm.weight', 'llama.layers.11.self_attn.k_proj.weight', 'llama.layers.11.self_attn.o_proj.weight', 'llama.layers.11.self_attn.q_proj.weight', 'llama.layers.11.self_attn.v_proj.weight', 'llama.layers.12.input_layernorm.weight', 'llama.layers.12.mlp.down_proj.weight', 'llama.layers.12.mlp.gate_proj.weight', 'llama.layers.12.mlp.up_proj.weight', 'llama.layers.12.post_attention_layernorm.weight', 'llama.layers.12.self_attn.k_proj.weight', 'llama.layers.12.self_attn.o_proj.weight', 'llama.layers.12.self_attn.q_proj.weight', 'llama.layers.12.self_attn.v_proj.weight', 'llama.layers.13.input_layernorm.weight', 'llama.layers.13.mlp.down_proj.weight', 'llama.layers.13.mlp.gate_proj.weight', 'llama.layers.13.mlp.up_proj.weight', 'llama.layers.13.post_attention_layernorm.weight', 'llama.layers.13.self_attn.k_proj.weight', 'llama.layers.13.self_attn.o_proj.weight', 'llama.layers.13.self_attn.q_proj.weight', 'llama.layers.13.self_attn.v_proj.weight', 'llama.layers.14.input_layernorm.weight', 'llama.layers.14.mlp.down_proj.weight', 'llama.layers.14.mlp.gate_proj.weight', 'llama.layers.14.mlp.up_proj.weight', 'llama.layers.14.post_attention_layernorm.weight', 'llama.layers.14.self_attn.k_proj.weight', 'llama.layers.14.self_attn.o_proj.weight', 'llama.layers.14.self_attn.q_proj.weight', 'llama.layers.14.self_attn.v_proj.weight', 'llama.layers.15.input_layernorm.weight', 'llama.layers.15.mlp.down_proj.weight', 'llama.layers.15.mlp.gate_proj.weight', 'llama.layers.15.mlp.up_proj.weight', 'llama.layers.15.post_attention_layernorm.weight', 'llama.layers.15.self_attn.k_proj.weight', 'llama.layers.15.self_attn.o_proj.weight', 'llama.layers.15.self_attn.q_proj.weight', 'llama.layers.15.self_attn.v_proj.weight', 'llama.layers.16.input_layernorm.weight', 'llama.layers.16.mlp.down_proj.weight', 'llama.layers.16.mlp.gate_proj.weight', 'llama.layers.16.mlp.up_proj.weight', 'llama.layers.16.post_attention_layernorm.weight', 'llama.layers.16.self_attn.k_proj.weight', 'llama.layers.16.self_attn.o_proj.weight', 'llama.layers.16.self_attn.q_proj.weight', 'llama.layers.16.self_attn.v_proj.weight', 'llama.layers.17.input_layernorm.weight', 'llama.layers.17.mlp.down_proj.weight', 'llama.layers.17.mlp.gate_proj.weight', 'llama.layers.17.mlp.up_proj.weight', 'llama.layers.17.post_attention_layernorm.weight', 'llama.layers.17.self_attn.k_proj.weight', 'llama.layers.17.self_attn.o_proj.weight', 'llama.layers.17.self_attn.q_proj.weight', 'llama.layers.17.self_attn.v_proj.weight', 'llama.layers.18.input_layernorm.weight', 'llama.layers.18.mlp.down_proj.weight', 'llama.layers.18.mlp.gate_proj.weight', 'llama.layers.18.mlp.up_proj.weight', 'llama.layers.18.post_attention_layernorm.weight', 'llama.layers.18.self_attn.k_proj.weight', 'llama.layers.18.self_attn.o_proj.weight', 'llama.layers.18.self_attn.q_proj.weight', 'llama.layers.18.self_attn.v_proj.weight', 'llama.layers.19.input_layernorm.weight', 'llama.layers.19.mlp.down_proj.weight', 'llama.layers.19.mlp.gate_proj.weight', 'llama.layers.19.mlp.up_proj.weight', 'llama.layers.19.post_attention_layernorm.weight', 'llama.layers.19.self_attn.k_proj.weight', 'llama.layers.19.self_attn.o_proj.weight', 'llama.layers.19.self_attn.q_proj.weight', 'llama.layers.19.self_attn.v_proj.weight', 'llama.layers.20.input_layernorm.weight', 'llama.layers.20.mlp.down_proj.weight', 'llama.layers.20.mlp.gate_proj.weight', 'llama.layers.20.mlp.up_proj.weight', 'llama.layers.20.post_attention_layernorm.weight', 'llama.layers.20.self_attn.k_proj.weight', 'llama.layers.20.self_attn.o_proj.weight', 'llama.layers.20.self_attn.q_proj.weight', 'llama.layers.20.self_attn.v_proj.weight', 'llama.layers.21.input_layernorm.weight', 'llama.layers.21.mlp.down_proj.weight', 'llama.layers.21.mlp.gate_proj.weight', 'llama.layers.21.mlp.up_proj.weight', 'llama.layers.21.post_attention_layernorm.weight', 'llama.layers.21.self_attn.k_proj.weight', 'llama.layers.21.self_attn.o_proj.weight', 'llama.layers.21.self_attn.q_proj.weight', 'llama.layers.21.self_attn.v_proj.weight', 'llama.layers.22.input_layernorm.weight', 'llama.layers.22.mlp.down_proj.weight', 'llama.layers.22.mlp.gate_proj.weight', 'llama.layers.22.mlp.up_proj.weight', 'llama.layers.22.post_attention_layernorm.weight', 'llama.layers.22.self_attn.k_proj.weight', 'llama.layers.22.self_attn.o_proj.weight', 'llama.layers.22.self_attn.q_proj.weight', 'llama.layers.22.self_attn.v_proj.weight', 'llama.layers.23.input_layernorm.weight', 'llama.layers.23.mlp.down_proj.weight', 'llama.layers.23.mlp.gate_proj.weight', 'llama.layers.23.mlp.up_proj.weight', 'llama.layers.23.post_attention_layernorm.weight', 'llama.layers.23.self_attn.k_proj.weight', 'llama.layers.23.self_attn.o_proj.weight', 'llama.layers.23.self_attn.q_proj.weight', 'llama.layers.23.self_attn.v_proj.weight', 'llama.layers.24.input_layernorm.weight', 'llama.layers.24.mlp.down_proj.weight', 'llama.layers.24.mlp.gate_proj.weight', 'llama.layers.24.mlp.up_proj.weight', 'llama.layers.24.post_attention_layernorm.weight', 'llama.layers.24.self_attn.k_proj.weight', 'llama.layers.24.self_attn.o_proj.weight', 'llama.layers.24.self_attn.q_proj.weight', 'llama.layers.24.self_attn.v_proj.weight', 'llama.layers.25.input_layernorm.weight', 'llama.layers.25.mlp.down_proj.weight', 'llama.layers.25.mlp.gate_proj.weight', 'llama.layers.25.mlp.up_proj.weight', 'llama.layers.25.post_attention_layernorm.weight', 'llama.layers.25.self_attn.k_proj.weight', 'llama.layers.25.self_attn.o_proj.weight', 'llama.layers.25.self_attn.q_proj.weight', 'llama.layers.25.self_attn.v_proj.weight', 'llama.layers.26.input_layernorm.weight', 'llama.layers.26.mlp.down_proj.weight', 'llama.layers.26.mlp.gate_proj.weight', 'llama.layers.26.mlp.up_proj.weight', 'llama.layers.26.post_attention_layernorm.weight', 'llama.layers.26.self_attn.k_proj.weight', 'llama.layers.26.self_attn.o_proj.weight', 'llama.layers.26.self_attn.q_proj.weight', 'llama.layers.26.self_attn.v_proj.weight', 'llama.layers.27.input_layernorm.weight', 'llama.layers.27.mlp.down_proj.weight', 'llama.layers.27.mlp.gate_proj.weight', 'llama.layers.27.mlp.up_proj.weight', 'llama.layers.27.post_attention_layernorm.weight', 'llama.layers.27.self_attn.k_proj.weight', 'llama.layers.27.self_attn.o_proj.weight', 'llama.layers.27.self_attn.q_proj.weight', 'llama.layers.27.self_attn.v_proj.weight', 'llama.layers.28.input_layernorm.weight', 'llama.layers.28.mlp.down_proj.weight', 'llama.layers.28.mlp.gate_proj.weight', 'llama.layers.28.mlp.up_proj.weight', 'llama.layers.28.post_attention_layernorm.weight', 'llama.layers.28.self_attn.k_proj.weight', 'llama.layers.28.self_attn.o_proj.weight', 'llama.layers.28.self_attn.q_proj.weight', 'llama.layers.28.self_attn.v_proj.weight', 'llama.layers.29.input_layernorm.weight', 'llama.layers.29.mlp.down_proj.weight', 'llama.layers.29.mlp.gate_proj.weight', 'llama.layers.29.mlp.up_proj.weight', 'llama.layers.29.post_attention_layernorm.weight', 'llama.layers.29.self_attn.k_proj.weight', 'llama.layers.29.self_attn.o_proj.weight', 'llama.layers.29.self_attn.q_proj.weight', 'llama.layers.29.self_attn.v_proj.weight', 'llama.layers.30.input_layernorm.weight', 'llama.layers.30.mlp.down_proj.weight', 'llama.layers.30.mlp.gate_proj.weight', 'llama.layers.30.mlp.up_proj.weight', 'llama.layers.30.post_attention_layernorm.weight', 'llama.layers.30.self_attn.k_proj.weight', 'llama.layers.30.self_attn.o_proj.weight', 'llama.layers.30.self_attn.q_proj.weight', 'llama.layers.30.self_attn.v_proj.weight', 'llama.layers.31.input_layernorm.weight', 'llama.layers.31.mlp.down_proj.weight', 'llama.layers.31.mlp.gate_proj.weight', 'llama.layers.31.mlp.up_proj.weight', 'llama.layers.31.post_attention_layernorm.weight', 'llama.layers.31.self_attn.k_proj.weight', 'llama.layers.31.self_attn.o_proj.weight', 'llama.layers.31.self_attn.q_proj.weight', 'llama.layers.31.self_attn.v_proj.weight', 'llama.layers.8.input_layernorm.weight', 'llama.layers.8.mlp.down_proj.weight', 'llama.layers.8.mlp.gate_proj.weight', 'llama.layers.8.mlp.up_proj.weight', 'llama.layers.8.post_attention_layernorm.weight', 'llama.layers.8.self_attn.k_proj.weight', 'llama.layers.8.self_attn.o_proj.weight', 'llama.layers.8.self_attn.q_proj.weight', 'llama.layers.8.self_attn.v_proj.weight', 'llama.layers.9.input_layernorm.weight', 'llama.layers.9.mlp.down_proj.weight', 'llama.layers.9.mlp.gate_proj.weight', 'llama.layers.9.mlp.up_proj.weight', 'llama.layers.9.post_attention_layernorm.weight', 'llama.layers.9.self_attn.k_proj.weight', 'llama.layers.9.self_attn.o_proj.weight', 'llama.layers.9.self_attn.q_proj.weight', 'llama.layers.9.self_attn.v_proj.weight', 'llama.norm.weight', 'lm_head.weight']
- This IS expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).[0m
[32m[2024-12-31 16:16:12,164] [    INFO][0m - All the weights of LlamaForCausalLMPipe were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLMPipe for predictions without further training.[0m
[32m[2024-12-31 16:16:13,482] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:16:13,487] [   DEBUG][0m - Frozen parameters: 1.75e+09 || Trainable parameters:5.00e+06 || Total parameters:1.76e+09|| Trainable:0.28%[0m
[35m[2024-12-31 16:16:13,487] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:16:14,089] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:16:14,198] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:16:14,223] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:16:14,223] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:16:14,223] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:16:14,224] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - dataset_world_size            : 1[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:16:14,225] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - enable_sharding_comm_overlap  : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - eval_batch_size               : 4[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:16:14,226] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-14-26_ubuntu[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:16:14,227] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - optimizer_name_suffix         : pp00[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:16:14,228] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - per_device_eval_batch_size    : 4[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - per_device_train_batch_size   : 1[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - pipeline_parallel_degree      : 4[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:16:14,229] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding                      : [][0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding_parallel_degree      : 1[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:16:14,230] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - train_batch_size              : 1[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:16:14,231] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - weight_name_suffix            : pp00[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:16:14,232] [   DEBUG][0m - [0m
[32m[2024-12-31 16:16:14,233] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:16:14,259] [    INFO] pipeline_parallel.py:331 - dp_comm_overlap False;             sharding_comm_overlap False;             sharding_split_param False;
[2024-12-31 16:16:14,259] [    INFO] pipeline_parallel.py:404 - Pipeline Info -- num_stages: 4, stage_id: 0
[2024-12-31 16:16:14,259] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:16:14,259] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:16:14) [0m
[32m[2024-12-31 16:16:14,259] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:16:14,259] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:16:14,259] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:16:14,259] [    INFO][0m -   Instantaneous batch size per device = 1[0m
[32m[2024-12-31 16:16:14,260] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 4[0m
[32m[2024-12-31 16:16:14,260] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:16:14,260] [    INFO][0m -   Total optimization steps = 377[0m
[32m[2024-12-31 16:16:14,260] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:16:14,261] [   DEBUG][0m -   Number of trainable parameters = 4,997,120 (per device)[0m
[35m[2024-12-31 16:16:14,261] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (all devices, roughly)[0m
/home/sjx/tr-paddle-1230/paddlenlp/transformers/tokenizer_utils_base.py:2097: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
W1231 16:16:15.859841 112003 multiply_fwd_func.cc:76] got different data type, run type promotion automatically, this may cause data type been changed.
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8415]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8455]
CUDA error (/paddle/third_party/flashattn/csrc/flash_attn/src/flash_fwd_launch_template.h:60): unspecified launch failure
terminate called after throwing an instance of 'common::enforce::EnforceNotMet'
  what():  (External) CUDA error(719), unspecified launch failure. 
  [Hint: 'cudaErrorLaunchFailure'. An exception occurred on the device while executing a kernel. Common causes include dereferencing an invalid device pointerand accessing out of bounds shared memory. Less common cases can be system specific - more information about these cases canbe found in the system specific user guide. This leaves the process in an inconsistent state and any further CUDA work willreturn the same error. To continue using CUDA, the process must be terminated and relaunched.] (at ../paddle/phi/backends/gpu/cuda/cuda_info.cc:296)

/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[33m[2024-12-31 16:28:46,434] [ WARNING][0m - sharding_parallel_degree=1 means no sharding, please set sharding to empty![0m
[2024-12-31 16:28:46,434] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
[32m[2024-12-31 16:28:46,434] [    INFO][0m - PP configs:{'micro_batch_size': 1, 'accumulate_steps': 4, 'schedule_mode': '1F1B', 'p2p_cache_shape': True, 'enable_partial_send_recv': True}, use master_grad: False[0m
[33m[2024-12-31 16:28:46,434] [ WARNING][0m - In pipeline model, the evaluation also shares same setting with training. We will enforce that per_device_eval_batch_size=per_device_train_batch_size * gradient_accumulation_steps.[0m
[32m[2024-12-31 16:28:46,434] [    INFO][0m - using pipeline configs:{'delay_scale_loss': False, 'dp_comm_overlap': False, 'sharding_comm_overlap': False, 'enable_timer': False, 'release_gradients': False, 'overlap_p2p_comm': False, 'clear_every_step_cache': False, 'use_batch_p2p_comm': True, 'best_unbalanced_scheduler': False}[0m
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
=======================================================================
I1231 16:28:46.435796 129646 tcp_utils.cc:181] The server starts to listen on IP_ANY:40539
I1231 16:28:46.436012 129646 tcp_utils.cc:130] Successfully connected to 10.3.242.26:40539
I1231 16:28:46.523208 129646 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:28:46.523227 129646 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:28:46.523501 129646 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:28:46.523512 129646 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:28:46,523] [    INFO] topology.py:370 - Total 1 pipe comm group(s) create successfully!
W1231 16:28:46.547048 129646 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:28:46.547827 129646 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
[2024-12-31 16:28:49,487] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:28:49,488] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
[2024-12-31 16:28:49,488] [    INFO] topology.py:370 - Total 4 sharding comm group(s) create successfully!
I1231 16:28:49.488514 129646 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:28:49.488543 129646 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:28:49.488596 129646 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:28:49.488603 129646 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:28:49,488] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 1, pp_degree: 4, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0], pp_group: [0, 1, 2, 3], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:28:49,488] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:28:49,489] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:28:49,489] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:28:49,490] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:28:49,491] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:28:49,492] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - [0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:28:49,493] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - [0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:28:49,494] [   DEBUG][0m - [0m
[32m[2024-12-31 16:28:49,496] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:28:49,496] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:28:49,497] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:28:49,499] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pipeline_parallel_degree": 4,
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:28:49,500] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling_pp.LlamaForCausalLMPipe'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:28:49,500] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:29:50,508] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[2024-12-31 16:29:50,513] [    INFO] pp_layers.py:609 - start segment network..
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:615 - segment with method: layer:LlamaDecoderLayer; result: 0, 9, 17, 25, 35
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:631 - stage=0, global_rank=0 ,layer_number=9
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 0: LlamaEmbeddingPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 1: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 2: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 3: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 4: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 5: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 6: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 7: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 8: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:631 - stage=1, global_rank=0 ,layer_number=8
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 9: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 10: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 11: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 12: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 13: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 14: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 15: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 16: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:631 - stage=2, global_rank=0 ,layer_number=8
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 17: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 18: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 19: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 20: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 21: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 22: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 23: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 24: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:631 - stage=3, global_rank=0 ,layer_number=10
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 25: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 26: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 27: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 28: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 29: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 30: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 31: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 32: LlamaDecoderLayerPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 33: LlamaRMSNormPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:636 - 34: LlamaLMHeadPipe
[2024-12-31 16:29:50,514] [    INFO] pp_layers.py:658 - loss: LlamaPretrainingCriterion
[2024-12-31 16:29:50,600] [    INFO] pp_layers.py:708 - flush 9 of layers into run_function
[33m[2024-12-31 16:30:08,684] [ WARNING][0m - Some weights of the model checkpoint at meta-llama/Llama-2-7b were not used when initializing LlamaForCausalLMPipe: ['llama.layers.10.input_layernorm.weight', 'llama.layers.10.mlp.down_proj.weight', 'llama.layers.10.mlp.gate_proj.weight', 'llama.layers.10.mlp.up_proj.weight', 'llama.layers.10.post_attention_layernorm.weight', 'llama.layers.10.self_attn.k_proj.weight', 'llama.layers.10.self_attn.o_proj.weight', 'llama.layers.10.self_attn.q_proj.weight', 'llama.layers.10.self_attn.v_proj.weight', 'llama.layers.11.input_layernorm.weight', 'llama.layers.11.mlp.down_proj.weight', 'llama.layers.11.mlp.gate_proj.weight', 'llama.layers.11.mlp.up_proj.weight', 'llama.layers.11.post_attention_layernorm.weight', 'llama.layers.11.self_attn.k_proj.weight', 'llama.layers.11.self_attn.o_proj.weight', 'llama.layers.11.self_attn.q_proj.weight', 'llama.layers.11.self_attn.v_proj.weight', 'llama.layers.12.input_layernorm.weight', 'llama.layers.12.mlp.down_proj.weight', 'llama.layers.12.mlp.gate_proj.weight', 'llama.layers.12.mlp.up_proj.weight', 'llama.layers.12.post_attention_layernorm.weight', 'llama.layers.12.self_attn.k_proj.weight', 'llama.layers.12.self_attn.o_proj.weight', 'llama.layers.12.self_attn.q_proj.weight', 'llama.layers.12.self_attn.v_proj.weight', 'llama.layers.13.input_layernorm.weight', 'llama.layers.13.mlp.down_proj.weight', 'llama.layers.13.mlp.gate_proj.weight', 'llama.layers.13.mlp.up_proj.weight', 'llama.layers.13.post_attention_layernorm.weight', 'llama.layers.13.self_attn.k_proj.weight', 'llama.layers.13.self_attn.o_proj.weight', 'llama.layers.13.self_attn.q_proj.weight', 'llama.layers.13.self_attn.v_proj.weight', 'llama.layers.14.input_layernorm.weight', 'llama.layers.14.mlp.down_proj.weight', 'llama.layers.14.mlp.gate_proj.weight', 'llama.layers.14.mlp.up_proj.weight', 'llama.layers.14.post_attention_layernorm.weight', 'llama.layers.14.self_attn.k_proj.weight', 'llama.layers.14.self_attn.o_proj.weight', 'llama.layers.14.self_attn.q_proj.weight', 'llama.layers.14.self_attn.v_proj.weight', 'llama.layers.15.input_layernorm.weight', 'llama.layers.15.mlp.down_proj.weight', 'llama.layers.15.mlp.gate_proj.weight', 'llama.layers.15.mlp.up_proj.weight', 'llama.layers.15.post_attention_layernorm.weight', 'llama.layers.15.self_attn.k_proj.weight', 'llama.layers.15.self_attn.o_proj.weight', 'llama.layers.15.self_attn.q_proj.weight', 'llama.layers.15.self_attn.v_proj.weight', 'llama.layers.16.input_layernorm.weight', 'llama.layers.16.mlp.down_proj.weight', 'llama.layers.16.mlp.gate_proj.weight', 'llama.layers.16.mlp.up_proj.weight', 'llama.layers.16.post_attention_layernorm.weight', 'llama.layers.16.self_attn.k_proj.weight', 'llama.layers.16.self_attn.o_proj.weight', 'llama.layers.16.self_attn.q_proj.weight', 'llama.layers.16.self_attn.v_proj.weight', 'llama.layers.17.input_layernorm.weight', 'llama.layers.17.mlp.down_proj.weight', 'llama.layers.17.mlp.gate_proj.weight', 'llama.layers.17.mlp.up_proj.weight', 'llama.layers.17.post_attention_layernorm.weight', 'llama.layers.17.self_attn.k_proj.weight', 'llama.layers.17.self_attn.o_proj.weight', 'llama.layers.17.self_attn.q_proj.weight', 'llama.layers.17.self_attn.v_proj.weight', 'llama.layers.18.input_layernorm.weight', 'llama.layers.18.mlp.down_proj.weight', 'llama.layers.18.mlp.gate_proj.weight', 'llama.layers.18.mlp.up_proj.weight', 'llama.layers.18.post_attention_layernorm.weight', 'llama.layers.18.self_attn.k_proj.weight', 'llama.layers.18.self_attn.o_proj.weight', 'llama.layers.18.self_attn.q_proj.weight', 'llama.layers.18.self_attn.v_proj.weight', 'llama.layers.19.input_layernorm.weight', 'llama.layers.19.mlp.down_proj.weight', 'llama.layers.19.mlp.gate_proj.weight', 'llama.layers.19.mlp.up_proj.weight', 'llama.layers.19.post_attention_layernorm.weight', 'llama.layers.19.self_attn.k_proj.weight', 'llama.layers.19.self_attn.o_proj.weight', 'llama.layers.19.self_attn.q_proj.weight', 'llama.layers.19.self_attn.v_proj.weight', 'llama.layers.20.input_layernorm.weight', 'llama.layers.20.mlp.down_proj.weight', 'llama.layers.20.mlp.gate_proj.weight', 'llama.layers.20.mlp.up_proj.weight', 'llama.layers.20.post_attention_layernorm.weight', 'llama.layers.20.self_attn.k_proj.weight', 'llama.layers.20.self_attn.o_proj.weight', 'llama.layers.20.self_attn.q_proj.weight', 'llama.layers.20.self_attn.v_proj.weight', 'llama.layers.21.input_layernorm.weight', 'llama.layers.21.mlp.down_proj.weight', 'llama.layers.21.mlp.gate_proj.weight', 'llama.layers.21.mlp.up_proj.weight', 'llama.layers.21.post_attention_layernorm.weight', 'llama.layers.21.self_attn.k_proj.weight', 'llama.layers.21.self_attn.o_proj.weight', 'llama.layers.21.self_attn.q_proj.weight', 'llama.layers.21.self_attn.v_proj.weight', 'llama.layers.22.input_layernorm.weight', 'llama.layers.22.mlp.down_proj.weight', 'llama.layers.22.mlp.gate_proj.weight', 'llama.layers.22.mlp.up_proj.weight', 'llama.layers.22.post_attention_layernorm.weight', 'llama.layers.22.self_attn.k_proj.weight', 'llama.layers.22.self_attn.o_proj.weight', 'llama.layers.22.self_attn.q_proj.weight', 'llama.layers.22.self_attn.v_proj.weight', 'llama.layers.23.input_layernorm.weight', 'llama.layers.23.mlp.down_proj.weight', 'llama.layers.23.mlp.gate_proj.weight', 'llama.layers.23.mlp.up_proj.weight', 'llama.layers.23.post_attention_layernorm.weight', 'llama.layers.23.self_attn.k_proj.weight', 'llama.layers.23.self_attn.o_proj.weight', 'llama.layers.23.self_attn.q_proj.weight', 'llama.layers.23.self_attn.v_proj.weight', 'llama.layers.24.input_layernorm.weight', 'llama.layers.24.mlp.down_proj.weight', 'llama.layers.24.mlp.gate_proj.weight', 'llama.layers.24.mlp.up_proj.weight', 'llama.layers.24.post_attention_layernorm.weight', 'llama.layers.24.self_attn.k_proj.weight', 'llama.layers.24.self_attn.o_proj.weight', 'llama.layers.24.self_attn.q_proj.weight', 'llama.layers.24.self_attn.v_proj.weight', 'llama.layers.25.input_layernorm.weight', 'llama.layers.25.mlp.down_proj.weight', 'llama.layers.25.mlp.gate_proj.weight', 'llama.layers.25.mlp.up_proj.weight', 'llama.layers.25.post_attention_layernorm.weight', 'llama.layers.25.self_attn.k_proj.weight', 'llama.layers.25.self_attn.o_proj.weight', 'llama.layers.25.self_attn.q_proj.weight', 'llama.layers.25.self_attn.v_proj.weight', 'llama.layers.26.input_layernorm.weight', 'llama.layers.26.mlp.down_proj.weight', 'llama.layers.26.mlp.gate_proj.weight', 'llama.layers.26.mlp.up_proj.weight', 'llama.layers.26.post_attention_layernorm.weight', 'llama.layers.26.self_attn.k_proj.weight', 'llama.layers.26.self_attn.o_proj.weight', 'llama.layers.26.self_attn.q_proj.weight', 'llama.layers.26.self_attn.v_proj.weight', 'llama.layers.27.input_layernorm.weight', 'llama.layers.27.mlp.down_proj.weight', 'llama.layers.27.mlp.gate_proj.weight', 'llama.layers.27.mlp.up_proj.weight', 'llama.layers.27.post_attention_layernorm.weight', 'llama.layers.27.self_attn.k_proj.weight', 'llama.layers.27.self_attn.o_proj.weight', 'llama.layers.27.self_attn.q_proj.weight', 'llama.layers.27.self_attn.v_proj.weight', 'llama.layers.28.input_layernorm.weight', 'llama.layers.28.mlp.down_proj.weight', 'llama.layers.28.mlp.gate_proj.weight', 'llama.layers.28.mlp.up_proj.weight', 'llama.layers.28.post_attention_layernorm.weight', 'llama.layers.28.self_attn.k_proj.weight', 'llama.layers.28.self_attn.o_proj.weight', 'llama.layers.28.self_attn.q_proj.weight', 'llama.layers.28.self_attn.v_proj.weight', 'llama.layers.29.input_layernorm.weight', 'llama.layers.29.mlp.down_proj.weight', 'llama.layers.29.mlp.gate_proj.weight', 'llama.layers.29.mlp.up_proj.weight', 'llama.layers.29.post_attention_layernorm.weight', 'llama.layers.29.self_attn.k_proj.weight', 'llama.layers.29.self_attn.o_proj.weight', 'llama.layers.29.self_attn.q_proj.weight', 'llama.layers.29.self_attn.v_proj.weight', 'llama.layers.30.input_layernorm.weight', 'llama.layers.30.mlp.down_proj.weight', 'llama.layers.30.mlp.gate_proj.weight', 'llama.layers.30.mlp.up_proj.weight', 'llama.layers.30.post_attention_layernorm.weight', 'llama.layers.30.self_attn.k_proj.weight', 'llama.layers.30.self_attn.o_proj.weight', 'llama.layers.30.self_attn.q_proj.weight', 'llama.layers.30.self_attn.v_proj.weight', 'llama.layers.31.input_layernorm.weight', 'llama.layers.31.mlp.down_proj.weight', 'llama.layers.31.mlp.gate_proj.weight', 'llama.layers.31.mlp.up_proj.weight', 'llama.layers.31.post_attention_layernorm.weight', 'llama.layers.31.self_attn.k_proj.weight', 'llama.layers.31.self_attn.o_proj.weight', 'llama.layers.31.self_attn.q_proj.weight', 'llama.layers.31.self_attn.v_proj.weight', 'llama.layers.8.input_layernorm.weight', 'llama.layers.8.mlp.down_proj.weight', 'llama.layers.8.mlp.gate_proj.weight', 'llama.layers.8.mlp.up_proj.weight', 'llama.layers.8.post_attention_layernorm.weight', 'llama.layers.8.self_attn.k_proj.weight', 'llama.layers.8.self_attn.o_proj.weight', 'llama.layers.8.self_attn.q_proj.weight', 'llama.layers.8.self_attn.v_proj.weight', 'llama.layers.9.input_layernorm.weight', 'llama.layers.9.mlp.down_proj.weight', 'llama.layers.9.mlp.gate_proj.weight', 'llama.layers.9.mlp.up_proj.weight', 'llama.layers.9.post_attention_layernorm.weight', 'llama.layers.9.self_attn.k_proj.weight', 'llama.layers.9.self_attn.o_proj.weight', 'llama.layers.9.self_attn.q_proj.weight', 'llama.layers.9.self_attn.v_proj.weight', 'llama.norm.weight', 'lm_head.weight']
- This IS expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).[0m
[32m[2024-12-31 16:30:08,684] [    INFO][0m - All the weights of LlamaForCausalLMPipe were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLMPipe for predictions without further training.[0m
[32m[2024-12-31 16:30:09,908] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:30:09,913] [   DEBUG][0m - Frozen parameters: 1.75e+09 || Trainable parameters:5.00e+06 || Total parameters:1.76e+09|| Trainable:0.28%[0m
[35m[2024-12-31 16:30:09,913] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:30:45,121] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:30:45,262] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:30:45,287] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:30:45,288] [   DEBUG][0m - dataset_world_size            : 1[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - enable_sharding_comm_overlap  : False[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - eval_batch_size               : 4[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:30:45,289] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:30:45,290] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-28-46_ubuntu[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:30:45,291] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - optimizer_name_suffix         : pp00[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - per_device_eval_batch_size    : 4[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - per_device_train_batch_size   : 1[0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:30:45,292] [   DEBUG][0m - pipeline_parallel_degree      : 4[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:30:45,293] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding                      : [][0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding_parallel_degree      : 1[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:30:45,294] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - train_batch_size              : 1[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:30:45,295] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - weight_name_suffix            : pp00[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:30:45,296] [   DEBUG][0m - [0m
[32m[2024-12-31 16:30:45,296] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:30:45,298] [    INFO] pipeline_parallel.py:331 - dp_comm_overlap False;             sharding_comm_overlap False;             sharding_split_param False;
[2024-12-31 16:30:45,298] [    INFO] pipeline_parallel.py:404 - Pipeline Info -- num_stages: 4, stage_id: 0
[2024-12-31 16:30:45,298] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:30:45,298] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:30:45) [0m
[32m[2024-12-31 16:30:45,298] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Instantaneous batch size per device = 1[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 4[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Total optimization steps = 377[0m
[32m[2024-12-31 16:30:45,299] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:30:45,300] [   DEBUG][0m -   Number of trainable parameters = 4,997,120 (per device)[0m
[35m[2024-12-31 16:30:45,300] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (all devices, roughly)[0m
Exception in thread Thread-3 (_thread_loop):
ValueError: 8192 is not a valid PaddingStrategy

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/threading.py", line 1009, in _bootstrap_inner
    self.run()
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/threading.py", line 946, in run
    self._target(*self._args, **self._kwargs)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/io/dataloader/dataloader_iter.py", line 245, in _thread_loop
    batch = self._dataset_fetcher.fetch(
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/io/dataloader/fetcher.py", line 77, in fetch
    data.append(self.dataset[idx])
  File "/home/sjx/tr-paddle-1230/paddlenlp/datasets/dataset.py", line 266, in __getitem__
    return self._transform(self.new_data[idx]) if self._transform_pipline else self.new_data[idx]
  File "/home/sjx/tr-paddle-1230/paddlenlp/datasets/dataset.py", line 258, in _transform
    data = fn(data)
  File "/home/sjx/tr-paddle-1230/llm/utils/data.py", line 204, in convert_example_common
    tokenized_source = tokenize_unsupervised_example(
  File "/home/sjx/tr-paddle-1230/llm/utils/data.py", line 81, in tokenize_unsupervised_example
    tokenized_source = tokenizer(
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/tokenizer_utils_base.py", line 2440, in __call__
    return self.encode(
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/tokenizer_utils_base.py", line 2510, in encode
    padding_strategy, truncation_strategy, max_length, kwargs = self._get_padding_truncation_strategies(
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/tokenizer_utils_base.py", line 2106, in _get_padding_truncation_strategies
    padding_strategy = PaddingStrategy(padding)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/enum.py", line 384, in __call__
    return cls.__new__(cls, value)
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/enum.py", line 708, in __new__
    raise exc
  File "/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/enum.py", line 692, in __new__
    result = cls._missing_(value)
  File "/home/sjx/tr-paddle-1230/paddlenlp/transformers/tokenizer_utils_base.py", line 120, in _missing_
    raise ValueError(
ValueError: 8192 is not a valid PaddingStrategy, please select one of ['longest', 'max_length', 'do_not_pad']
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[33m[2024-12-31 16:31:44,200] [ WARNING][0m - sharding_parallel_degree=1 means no sharding, please set sharding to empty![0m
[2024-12-31 16:31:44,200] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
[32m[2024-12-31 16:31:44,201] [    INFO][0m - PP configs:{'micro_batch_size': 1, 'accumulate_steps': 4, 'schedule_mode': '1F1B', 'p2p_cache_shape': True, 'enable_partial_send_recv': True}, use master_grad: False[0m
[33m[2024-12-31 16:31:44,201] [ WARNING][0m - In pipeline model, the evaluation also shares same setting with training. We will enforce that per_device_eval_batch_size=per_device_train_batch_size * gradient_accumulation_steps.[0m
[32m[2024-12-31 16:31:44,201] [    INFO][0m - using pipeline configs:{'delay_scale_loss': False, 'dp_comm_overlap': False, 'sharding_comm_overlap': False, 'enable_timer': False, 'release_gradients': False, 'overlap_p2p_comm': False, 'clear_every_step_cache': False, 'use_batch_p2p_comm': True, 'best_unbalanced_scheduler': False}[0m
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
=======================================================================
I1231 16:31:44.203032 133202 tcp_utils.cc:181] The server starts to listen on IP_ANY:51282
I1231 16:31:44.203253 133202 tcp_utils.cc:130] Successfully connected to 10.3.242.26:51282
I1231 16:31:47.375555 133202 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:31:47.375633 133202 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:31:47.376683 133202 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:31:47.376717 133202 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:31:47,376] [    INFO] topology.py:370 - Total 1 pipe comm group(s) create successfully!
W1231 16:31:47.415333 133202 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:31:47.419274 133202 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
[2024-12-31 16:31:50,164] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:31:50,165] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
[2024-12-31 16:31:50,166] [    INFO] topology.py:370 - Total 4 sharding comm group(s) create successfully!
I1231 16:31:50.166576 133202 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:31:50.166630 133202 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:31:50.166747 133202 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:31:50.166762 133202 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:31:50,167] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 1, pp_degree: 4, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0], pp_group: [0, 1, 2, 3], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:31:50,167] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:31:50,169] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:31:50,170] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:31:50,170] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:31:50,170] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:31:50,170] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:31:50,171] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:31:50,171] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:31:50,171] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:31:50,171] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:31:50,171] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:31:50,172] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:31:50,172] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:31:50,172] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:31:50,172] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:31:50,172] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:31:50,172] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:31:50,173] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:31:50,173] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:31:50,173] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:31:50,173] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:31:50,173] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:31:50,173] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:31:50,174] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:31:50,175] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:31:50,175] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:31:50,175] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:31:50,175] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:31:50,175] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:31:50,176] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:31:50,176] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:31:50,176] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:31:50,176] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:31:50,176] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:31:50,176] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:31:50,177] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:31:50,177] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:31:50,177] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:31:50,177] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:31:50,177] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:31:50,177] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:31:50,178] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:31:50,178] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:31:50,178] [   DEBUG][0m - [0m
[35m[2024-12-31 16:31:50,178] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:31:50,178] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:31:50,178] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:31:50,179] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:31:50,179] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:31:50,179] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:31:50,179] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:31:50,179] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:31:50,179] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:31:50,180] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:31:50,180] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:31:50,180] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:31:50,180] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:31:50,180] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:31:50,180] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:31:50,181] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:31:50,181] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:31:50,181] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:31:50,181] [   DEBUG][0m - [0m
[35m[2024-12-31 16:31:50,181] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:31:50,181] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:31:50,182] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:31:50,182] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:31:50,182] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:31:50,182] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:31:50,182] [   DEBUG][0m - [0m
[32m[2024-12-31 16:31:50,187] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:31:50,188] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:31:50,191] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:31:50,197] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pipeline_parallel_degree": 4,
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:31:50,199] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling_pp.LlamaForCausalLMPipe'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:31:50,200] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:32:53,052] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[2024-12-31 16:32:53,060] [    INFO] pp_layers.py:609 - start segment network..
[2024-12-31 16:32:53,060] [    INFO] pp_layers.py:615 - segment with method: layer:LlamaDecoderLayer; result: 0, 9, 17, 25, 35
[2024-12-31 16:32:53,060] [    INFO] pp_layers.py:631 - stage=0, global_rank=0 ,layer_number=9
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 0: LlamaEmbeddingPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 1: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 2: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 3: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 4: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 5: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 6: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 7: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 8: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:631 - stage=1, global_rank=0 ,layer_number=8
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 9: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 10: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 11: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 12: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 13: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 14: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 15: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 16: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:631 - stage=2, global_rank=0 ,layer_number=8
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 17: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 18: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 19: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 20: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 21: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 22: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 23: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 24: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:631 - stage=3, global_rank=0 ,layer_number=10
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 25: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 26: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 27: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 28: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 29: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 30: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 31: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 32: LlamaDecoderLayerPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 33: LlamaRMSNormPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:636 - 34: LlamaLMHeadPipe
[2024-12-31 16:32:53,061] [    INFO] pp_layers.py:658 - loss: LlamaPretrainingCriterion
[2024-12-31 16:32:53,160] [    INFO] pp_layers.py:708 - flush 9 of layers into run_function
[33m[2024-12-31 16:33:14,677] [ WARNING][0m - Some weights of the model checkpoint at meta-llama/Llama-2-7b were not used when initializing LlamaForCausalLMPipe: ['llama.layers.10.input_layernorm.weight', 'llama.layers.10.mlp.down_proj.weight', 'llama.layers.10.mlp.gate_proj.weight', 'llama.layers.10.mlp.up_proj.weight', 'llama.layers.10.post_attention_layernorm.weight', 'llama.layers.10.self_attn.k_proj.weight', 'llama.layers.10.self_attn.o_proj.weight', 'llama.layers.10.self_attn.q_proj.weight', 'llama.layers.10.self_attn.v_proj.weight', 'llama.layers.11.input_layernorm.weight', 'llama.layers.11.mlp.down_proj.weight', 'llama.layers.11.mlp.gate_proj.weight', 'llama.layers.11.mlp.up_proj.weight', 'llama.layers.11.post_attention_layernorm.weight', 'llama.layers.11.self_attn.k_proj.weight', 'llama.layers.11.self_attn.o_proj.weight', 'llama.layers.11.self_attn.q_proj.weight', 'llama.layers.11.self_attn.v_proj.weight', 'llama.layers.12.input_layernorm.weight', 'llama.layers.12.mlp.down_proj.weight', 'llama.layers.12.mlp.gate_proj.weight', 'llama.layers.12.mlp.up_proj.weight', 'llama.layers.12.post_attention_layernorm.weight', 'llama.layers.12.self_attn.k_proj.weight', 'llama.layers.12.self_attn.o_proj.weight', 'llama.layers.12.self_attn.q_proj.weight', 'llama.layers.12.self_attn.v_proj.weight', 'llama.layers.13.input_layernorm.weight', 'llama.layers.13.mlp.down_proj.weight', 'llama.layers.13.mlp.gate_proj.weight', 'llama.layers.13.mlp.up_proj.weight', 'llama.layers.13.post_attention_layernorm.weight', 'llama.layers.13.self_attn.k_proj.weight', 'llama.layers.13.self_attn.o_proj.weight', 'llama.layers.13.self_attn.q_proj.weight', 'llama.layers.13.self_attn.v_proj.weight', 'llama.layers.14.input_layernorm.weight', 'llama.layers.14.mlp.down_proj.weight', 'llama.layers.14.mlp.gate_proj.weight', 'llama.layers.14.mlp.up_proj.weight', 'llama.layers.14.post_attention_layernorm.weight', 'llama.layers.14.self_attn.k_proj.weight', 'llama.layers.14.self_attn.o_proj.weight', 'llama.layers.14.self_attn.q_proj.weight', 'llama.layers.14.self_attn.v_proj.weight', 'llama.layers.15.input_layernorm.weight', 'llama.layers.15.mlp.down_proj.weight', 'llama.layers.15.mlp.gate_proj.weight', 'llama.layers.15.mlp.up_proj.weight', 'llama.layers.15.post_attention_layernorm.weight', 'llama.layers.15.self_attn.k_proj.weight', 'llama.layers.15.self_attn.o_proj.weight', 'llama.layers.15.self_attn.q_proj.weight', 'llama.layers.15.self_attn.v_proj.weight', 'llama.layers.16.input_layernorm.weight', 'llama.layers.16.mlp.down_proj.weight', 'llama.layers.16.mlp.gate_proj.weight', 'llama.layers.16.mlp.up_proj.weight', 'llama.layers.16.post_attention_layernorm.weight', 'llama.layers.16.self_attn.k_proj.weight', 'llama.layers.16.self_attn.o_proj.weight', 'llama.layers.16.self_attn.q_proj.weight', 'llama.layers.16.self_attn.v_proj.weight', 'llama.layers.17.input_layernorm.weight', 'llama.layers.17.mlp.down_proj.weight', 'llama.layers.17.mlp.gate_proj.weight', 'llama.layers.17.mlp.up_proj.weight', 'llama.layers.17.post_attention_layernorm.weight', 'llama.layers.17.self_attn.k_proj.weight', 'llama.layers.17.self_attn.o_proj.weight', 'llama.layers.17.self_attn.q_proj.weight', 'llama.layers.17.self_attn.v_proj.weight', 'llama.layers.18.input_layernorm.weight', 'llama.layers.18.mlp.down_proj.weight', 'llama.layers.18.mlp.gate_proj.weight', 'llama.layers.18.mlp.up_proj.weight', 'llama.layers.18.post_attention_layernorm.weight', 'llama.layers.18.self_attn.k_proj.weight', 'llama.layers.18.self_attn.o_proj.weight', 'llama.layers.18.self_attn.q_proj.weight', 'llama.layers.18.self_attn.v_proj.weight', 'llama.layers.19.input_layernorm.weight', 'llama.layers.19.mlp.down_proj.weight', 'llama.layers.19.mlp.gate_proj.weight', 'llama.layers.19.mlp.up_proj.weight', 'llama.layers.19.post_attention_layernorm.weight', 'llama.layers.19.self_attn.k_proj.weight', 'llama.layers.19.self_attn.o_proj.weight', 'llama.layers.19.self_attn.q_proj.weight', 'llama.layers.19.self_attn.v_proj.weight', 'llama.layers.20.input_layernorm.weight', 'llama.layers.20.mlp.down_proj.weight', 'llama.layers.20.mlp.gate_proj.weight', 'llama.layers.20.mlp.up_proj.weight', 'llama.layers.20.post_attention_layernorm.weight', 'llama.layers.20.self_attn.k_proj.weight', 'llama.layers.20.self_attn.o_proj.weight', 'llama.layers.20.self_attn.q_proj.weight', 'llama.layers.20.self_attn.v_proj.weight', 'llama.layers.21.input_layernorm.weight', 'llama.layers.21.mlp.down_proj.weight', 'llama.layers.21.mlp.gate_proj.weight', 'llama.layers.21.mlp.up_proj.weight', 'llama.layers.21.post_attention_layernorm.weight', 'llama.layers.21.self_attn.k_proj.weight', 'llama.layers.21.self_attn.o_proj.weight', 'llama.layers.21.self_attn.q_proj.weight', 'llama.layers.21.self_attn.v_proj.weight', 'llama.layers.22.input_layernorm.weight', 'llama.layers.22.mlp.down_proj.weight', 'llama.layers.22.mlp.gate_proj.weight', 'llama.layers.22.mlp.up_proj.weight', 'llama.layers.22.post_attention_layernorm.weight', 'llama.layers.22.self_attn.k_proj.weight', 'llama.layers.22.self_attn.o_proj.weight', 'llama.layers.22.self_attn.q_proj.weight', 'llama.layers.22.self_attn.v_proj.weight', 'llama.layers.23.input_layernorm.weight', 'llama.layers.23.mlp.down_proj.weight', 'llama.layers.23.mlp.gate_proj.weight', 'llama.layers.23.mlp.up_proj.weight', 'llama.layers.23.post_attention_layernorm.weight', 'llama.layers.23.self_attn.k_proj.weight', 'llama.layers.23.self_attn.o_proj.weight', 'llama.layers.23.self_attn.q_proj.weight', 'llama.layers.23.self_attn.v_proj.weight', 'llama.layers.24.input_layernorm.weight', 'llama.layers.24.mlp.down_proj.weight', 'llama.layers.24.mlp.gate_proj.weight', 'llama.layers.24.mlp.up_proj.weight', 'llama.layers.24.post_attention_layernorm.weight', 'llama.layers.24.self_attn.k_proj.weight', 'llama.layers.24.self_attn.o_proj.weight', 'llama.layers.24.self_attn.q_proj.weight', 'llama.layers.24.self_attn.v_proj.weight', 'llama.layers.25.input_layernorm.weight', 'llama.layers.25.mlp.down_proj.weight', 'llama.layers.25.mlp.gate_proj.weight', 'llama.layers.25.mlp.up_proj.weight', 'llama.layers.25.post_attention_layernorm.weight', 'llama.layers.25.self_attn.k_proj.weight', 'llama.layers.25.self_attn.o_proj.weight', 'llama.layers.25.self_attn.q_proj.weight', 'llama.layers.25.self_attn.v_proj.weight', 'llama.layers.26.input_layernorm.weight', 'llama.layers.26.mlp.down_proj.weight', 'llama.layers.26.mlp.gate_proj.weight', 'llama.layers.26.mlp.up_proj.weight', 'llama.layers.26.post_attention_layernorm.weight', 'llama.layers.26.self_attn.k_proj.weight', 'llama.layers.26.self_attn.o_proj.weight', 'llama.layers.26.self_attn.q_proj.weight', 'llama.layers.26.self_attn.v_proj.weight', 'llama.layers.27.input_layernorm.weight', 'llama.layers.27.mlp.down_proj.weight', 'llama.layers.27.mlp.gate_proj.weight', 'llama.layers.27.mlp.up_proj.weight', 'llama.layers.27.post_attention_layernorm.weight', 'llama.layers.27.self_attn.k_proj.weight', 'llama.layers.27.self_attn.o_proj.weight', 'llama.layers.27.self_attn.q_proj.weight', 'llama.layers.27.self_attn.v_proj.weight', 'llama.layers.28.input_layernorm.weight', 'llama.layers.28.mlp.down_proj.weight', 'llama.layers.28.mlp.gate_proj.weight', 'llama.layers.28.mlp.up_proj.weight', 'llama.layers.28.post_attention_layernorm.weight', 'llama.layers.28.self_attn.k_proj.weight', 'llama.layers.28.self_attn.o_proj.weight', 'llama.layers.28.self_attn.q_proj.weight', 'llama.layers.28.self_attn.v_proj.weight', 'llama.layers.29.input_layernorm.weight', 'llama.layers.29.mlp.down_proj.weight', 'llama.layers.29.mlp.gate_proj.weight', 'llama.layers.29.mlp.up_proj.weight', 'llama.layers.29.post_attention_layernorm.weight', 'llama.layers.29.self_attn.k_proj.weight', 'llama.layers.29.self_attn.o_proj.weight', 'llama.layers.29.self_attn.q_proj.weight', 'llama.layers.29.self_attn.v_proj.weight', 'llama.layers.30.input_layernorm.weight', 'llama.layers.30.mlp.down_proj.weight', 'llama.layers.30.mlp.gate_proj.weight', 'llama.layers.30.mlp.up_proj.weight', 'llama.layers.30.post_attention_layernorm.weight', 'llama.layers.30.self_attn.k_proj.weight', 'llama.layers.30.self_attn.o_proj.weight', 'llama.layers.30.self_attn.q_proj.weight', 'llama.layers.30.self_attn.v_proj.weight', 'llama.layers.31.input_layernorm.weight', 'llama.layers.31.mlp.down_proj.weight', 'llama.layers.31.mlp.gate_proj.weight', 'llama.layers.31.mlp.up_proj.weight', 'llama.layers.31.post_attention_layernorm.weight', 'llama.layers.31.self_attn.k_proj.weight', 'llama.layers.31.self_attn.o_proj.weight', 'llama.layers.31.self_attn.q_proj.weight', 'llama.layers.31.self_attn.v_proj.weight', 'llama.layers.8.input_layernorm.weight', 'llama.layers.8.mlp.down_proj.weight', 'llama.layers.8.mlp.gate_proj.weight', 'llama.layers.8.mlp.up_proj.weight', 'llama.layers.8.post_attention_layernorm.weight', 'llama.layers.8.self_attn.k_proj.weight', 'llama.layers.8.self_attn.o_proj.weight', 'llama.layers.8.self_attn.q_proj.weight', 'llama.layers.8.self_attn.v_proj.weight', 'llama.layers.9.input_layernorm.weight', 'llama.layers.9.mlp.down_proj.weight', 'llama.layers.9.mlp.gate_proj.weight', 'llama.layers.9.mlp.up_proj.weight', 'llama.layers.9.post_attention_layernorm.weight', 'llama.layers.9.self_attn.k_proj.weight', 'llama.layers.9.self_attn.o_proj.weight', 'llama.layers.9.self_attn.q_proj.weight', 'llama.layers.9.self_attn.v_proj.weight', 'llama.norm.weight', 'lm_head.weight']
- This IS expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).[0m
[32m[2024-12-31 16:33:14,678] [    INFO][0m - All the weights of LlamaForCausalLMPipe were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLMPipe for predictions without further training.[0m
[32m[2024-12-31 16:33:15,998] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:33:16,002] [   DEBUG][0m - Frozen parameters: 1.75e+09 || Trainable parameters:5.00e+06 || Total parameters:1.76e+09|| Trainable:0.28%[0m
[35m[2024-12-31 16:33:16,003] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:33:20,763] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:33:20,912] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:33:20,936] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:33:20,937] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - dataset_world_size            : 1[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:33:20,938] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - enable_sharding_comm_overlap  : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - eval_batch_size               : 4[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:33:20,939] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-31-44_ubuntu[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:33:20,940] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - optimizer_name_suffix         : pp00[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:33:20,941] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - per_device_eval_batch_size    : 4[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - per_device_train_batch_size   : 1[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - pipeline_parallel_degree      : 4[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:33:20,942] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding                      : [][0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding_parallel_degree      : 1[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:33:20,943] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - train_batch_size              : 1[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:33:20,944] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - weight_name_suffix            : pp00[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:33:20,945] [   DEBUG][0m - [0m
[32m[2024-12-31 16:33:20,946] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:33:20,948] [    INFO] pipeline_parallel.py:331 - dp_comm_overlap False;             sharding_comm_overlap False;             sharding_split_param False;
[2024-12-31 16:33:20,948] [    INFO] pipeline_parallel.py:404 - Pipeline Info -- num_stages: 4, stage_id: 0
[2024-12-31 16:33:20,948] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:33:20,948] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:33:20) [0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Instantaneous batch size per device = 1[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 4[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Total optimization steps = 377[0m
[32m[2024-12-31 16:33:20,948] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:33:20,950] [   DEBUG][0m -   Number of trainable parameters = 4,997,120 (per device)[0m
[35m[2024-12-31 16:33:20,950] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (all devices, roughly)[0m
W1231 16:33:22.659152 133202 multiply_fwd_func.cc:76] got different data type, run type promotion automatically, this may cause data type been changed.
success
comehere
this
finish
CUDA error (/paddle/third_party/flashattn/csrc/flash_attn/src/flash_fwd_launch_template.h:60): unspecified launch failure
terminate called after throwing an instance of 'common::enforce::EnforceNotMet'
  what():  (External) CUDA error(719), unspecified launch failure. 
  [Hint: 'cudaErrorLaunchFailure'. An exception occurred on the device while executing a kernel. Common causes include dereferencing an invalid device pointerand accessing out of bounds shared memory. Less common cases can be system specific - more information about these cases canbe found in the system specific user guide. This leaves the process in an inconsistent state and any further CUDA work willreturn the same error. To continue using CUDA, the process must be terminated and relaunched.] (at ../paddle/phi/backends/gpu/cuda/cuda_info.cc:296)

/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[33m[2024-12-31 16:37:07,441] [ WARNING][0m - sharding_parallel_degree=1 means no sharding, please set sharding to empty![0m
[2024-12-31 16:37:07,441] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
[32m[2024-12-31 16:37:07,441] [    INFO][0m - PP configs:{'micro_batch_size': 1, 'accumulate_steps': 4, 'schedule_mode': '1F1B', 'p2p_cache_shape': True, 'enable_partial_send_recv': True}, use master_grad: False[0m
[33m[2024-12-31 16:37:07,441] [ WARNING][0m - In pipeline model, the evaluation also shares same setting with training. We will enforce that per_device_eval_batch_size=per_device_train_batch_size * gradient_accumulation_steps.[0m
[32m[2024-12-31 16:37:07,441] [    INFO][0m - using pipeline configs:{'delay_scale_loss': False, 'dp_comm_overlap': False, 'sharding_comm_overlap': False, 'enable_timer': False, 'release_gradients': False, 'overlap_p2p_comm': False, 'clear_every_step_cache': False, 'use_batch_p2p_comm': True, 'best_unbalanced_scheduler': False}[0m
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
=======================================================================
I1231 16:37:07.442976 138014 tcp_utils.cc:181] The server starts to listen on IP_ANY:40133
I1231 16:37:07.443147 138014 tcp_utils.cc:130] Successfully connected to 10.3.242.26:40133
I1231 16:37:10.507426 138014 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:37:10.507498 138014 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:37:10.508384 138014 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:37:10.508419 138014 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:37:10,508] [    INFO] topology.py:370 - Total 1 pipe comm group(s) create successfully!
W1231 16:37:10.550597 138014 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:37:10.553010 138014 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
[2024-12-31 16:37:12,987] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:37:12,988] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
[2024-12-31 16:37:12,988] [    INFO] topology.py:370 - Total 4 sharding comm group(s) create successfully!
I1231 16:37:12.989081 138014 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:37:12.989132 138014 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:37:12.989244 138014 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:37:12.989259 138014 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:37:12,989] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 1, pp_degree: 4, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0], pp_group: [0, 1, 2, 3], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:37:12,990] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:37:12,992] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:37:12,993] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:37:12,993] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:37:12,993] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:37:12,993] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:37:12,994] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:37:12,994] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:37:12,994] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:37:12,994] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:37:12,994] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:37:12,994] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:37:12,995] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:37:12,995] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:37:12,995] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:37:12,995] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:37:12,995] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:37:12,996] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:37:12,996] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:37:12,996] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:37:12,996] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:37:12,996] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:37:12,996] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:37:12,997] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:37:12,997] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:37:12,997] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:37:12,997] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:37:12,997] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:37:12,997] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:37:12,998] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:37:12,998] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:37:12,998] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:37:12,998] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:37:12,998] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:37:12,998] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:37:12,999] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:37:12,999] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:37:12,999] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:37:12,999] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:37:12,999] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:37:12,999] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:37:13,000] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:37:13,000] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:37:13,000] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:37:13,000] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:37:13,000] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:37:13,000] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:37:13,001] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:37:13,001] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:37:13,001] [   DEBUG][0m - [0m
[35m[2024-12-31 16:37:13,001] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:37:13,001] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:37:13,001] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:37:13,002] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:37:13,002] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:37:13,002] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:37:13,002] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:37:13,002] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:37:13,003] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:37:13,003] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:37:13,003] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:37:13,003] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:37:13,003] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:37:13,003] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:37:13,004] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:37:13,004] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:37:13,004] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:37:13,004] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:37:13,004] [   DEBUG][0m - [0m
[35m[2024-12-31 16:37:13,004] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:37:13,005] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:37:13,005] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:37:13,005] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:37:13,005] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:37:13,005] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:37:13,006] [   DEBUG][0m - [0m
[32m[2024-12-31 16:37:13,010] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:37:13,011] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:37:13,014] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:37:13,020] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pipeline_parallel_degree": 4,
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:37:13,021] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling_pp.LlamaForCausalLMPipe'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:37:13,022] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:38:18,999] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[2024-12-31 16:38:19,003] [    INFO] pp_layers.py:609 - start segment network..
[2024-12-31 16:38:19,003] [    INFO] pp_layers.py:615 - segment with method: layer:LlamaDecoderLayer; result: 0, 9, 17, 25, 35
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:631 - stage=0, global_rank=0 ,layer_number=9
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 0: LlamaEmbeddingPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 1: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 2: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 3: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 4: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 5: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 6: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 7: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 8: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:631 - stage=1, global_rank=0 ,layer_number=8
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 9: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 10: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 11: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 12: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 13: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 14: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 15: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 16: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:631 - stage=2, global_rank=0 ,layer_number=8
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 17: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 18: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 19: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 20: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 21: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 22: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 23: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 24: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:631 - stage=3, global_rank=0 ,layer_number=10
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 25: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 26: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 27: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 28: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 29: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 30: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 31: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 32: LlamaDecoderLayerPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 33: LlamaRMSNormPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:636 - 34: LlamaLMHeadPipe
[2024-12-31 16:38:19,004] [    INFO] pp_layers.py:658 - loss: LlamaPretrainingCriterion
[2024-12-31 16:38:19,083] [    INFO] pp_layers.py:708 - flush 9 of layers into run_function
[33m[2024-12-31 16:38:39,430] [ WARNING][0m - Some weights of the model checkpoint at meta-llama/Llama-2-7b were not used when initializing LlamaForCausalLMPipe: ['llama.layers.10.input_layernorm.weight', 'llama.layers.10.mlp.down_proj.weight', 'llama.layers.10.mlp.gate_proj.weight', 'llama.layers.10.mlp.up_proj.weight', 'llama.layers.10.post_attention_layernorm.weight', 'llama.layers.10.self_attn.k_proj.weight', 'llama.layers.10.self_attn.o_proj.weight', 'llama.layers.10.self_attn.q_proj.weight', 'llama.layers.10.self_attn.v_proj.weight', 'llama.layers.11.input_layernorm.weight', 'llama.layers.11.mlp.down_proj.weight', 'llama.layers.11.mlp.gate_proj.weight', 'llama.layers.11.mlp.up_proj.weight', 'llama.layers.11.post_attention_layernorm.weight', 'llama.layers.11.self_attn.k_proj.weight', 'llama.layers.11.self_attn.o_proj.weight', 'llama.layers.11.self_attn.q_proj.weight', 'llama.layers.11.self_attn.v_proj.weight', 'llama.layers.12.input_layernorm.weight', 'llama.layers.12.mlp.down_proj.weight', 'llama.layers.12.mlp.gate_proj.weight', 'llama.layers.12.mlp.up_proj.weight', 'llama.layers.12.post_attention_layernorm.weight', 'llama.layers.12.self_attn.k_proj.weight', 'llama.layers.12.self_attn.o_proj.weight', 'llama.layers.12.self_attn.q_proj.weight', 'llama.layers.12.self_attn.v_proj.weight', 'llama.layers.13.input_layernorm.weight', 'llama.layers.13.mlp.down_proj.weight', 'llama.layers.13.mlp.gate_proj.weight', 'llama.layers.13.mlp.up_proj.weight', 'llama.layers.13.post_attention_layernorm.weight', 'llama.layers.13.self_attn.k_proj.weight', 'llama.layers.13.self_attn.o_proj.weight', 'llama.layers.13.self_attn.q_proj.weight', 'llama.layers.13.self_attn.v_proj.weight', 'llama.layers.14.input_layernorm.weight', 'llama.layers.14.mlp.down_proj.weight', 'llama.layers.14.mlp.gate_proj.weight', 'llama.layers.14.mlp.up_proj.weight', 'llama.layers.14.post_attention_layernorm.weight', 'llama.layers.14.self_attn.k_proj.weight', 'llama.layers.14.self_attn.o_proj.weight', 'llama.layers.14.self_attn.q_proj.weight', 'llama.layers.14.self_attn.v_proj.weight', 'llama.layers.15.input_layernorm.weight', 'llama.layers.15.mlp.down_proj.weight', 'llama.layers.15.mlp.gate_proj.weight', 'llama.layers.15.mlp.up_proj.weight', 'llama.layers.15.post_attention_layernorm.weight', 'llama.layers.15.self_attn.k_proj.weight', 'llama.layers.15.self_attn.o_proj.weight', 'llama.layers.15.self_attn.q_proj.weight', 'llama.layers.15.self_attn.v_proj.weight', 'llama.layers.16.input_layernorm.weight', 'llama.layers.16.mlp.down_proj.weight', 'llama.layers.16.mlp.gate_proj.weight', 'llama.layers.16.mlp.up_proj.weight', 'llama.layers.16.post_attention_layernorm.weight', 'llama.layers.16.self_attn.k_proj.weight', 'llama.layers.16.self_attn.o_proj.weight', 'llama.layers.16.self_attn.q_proj.weight', 'llama.layers.16.self_attn.v_proj.weight', 'llama.layers.17.input_layernorm.weight', 'llama.layers.17.mlp.down_proj.weight', 'llama.layers.17.mlp.gate_proj.weight', 'llama.layers.17.mlp.up_proj.weight', 'llama.layers.17.post_attention_layernorm.weight', 'llama.layers.17.self_attn.k_proj.weight', 'llama.layers.17.self_attn.o_proj.weight', 'llama.layers.17.self_attn.q_proj.weight', 'llama.layers.17.self_attn.v_proj.weight', 'llama.layers.18.input_layernorm.weight', 'llama.layers.18.mlp.down_proj.weight', 'llama.layers.18.mlp.gate_proj.weight', 'llama.layers.18.mlp.up_proj.weight', 'llama.layers.18.post_attention_layernorm.weight', 'llama.layers.18.self_attn.k_proj.weight', 'llama.layers.18.self_attn.o_proj.weight', 'llama.layers.18.self_attn.q_proj.weight', 'llama.layers.18.self_attn.v_proj.weight', 'llama.layers.19.input_layernorm.weight', 'llama.layers.19.mlp.down_proj.weight', 'llama.layers.19.mlp.gate_proj.weight', 'llama.layers.19.mlp.up_proj.weight', 'llama.layers.19.post_attention_layernorm.weight', 'llama.layers.19.self_attn.k_proj.weight', 'llama.layers.19.self_attn.o_proj.weight', 'llama.layers.19.self_attn.q_proj.weight', 'llama.layers.19.self_attn.v_proj.weight', 'llama.layers.20.input_layernorm.weight', 'llama.layers.20.mlp.down_proj.weight', 'llama.layers.20.mlp.gate_proj.weight', 'llama.layers.20.mlp.up_proj.weight', 'llama.layers.20.post_attention_layernorm.weight', 'llama.layers.20.self_attn.k_proj.weight', 'llama.layers.20.self_attn.o_proj.weight', 'llama.layers.20.self_attn.q_proj.weight', 'llama.layers.20.self_attn.v_proj.weight', 'llama.layers.21.input_layernorm.weight', 'llama.layers.21.mlp.down_proj.weight', 'llama.layers.21.mlp.gate_proj.weight', 'llama.layers.21.mlp.up_proj.weight', 'llama.layers.21.post_attention_layernorm.weight', 'llama.layers.21.self_attn.k_proj.weight', 'llama.layers.21.self_attn.o_proj.weight', 'llama.layers.21.self_attn.q_proj.weight', 'llama.layers.21.self_attn.v_proj.weight', 'llama.layers.22.input_layernorm.weight', 'llama.layers.22.mlp.down_proj.weight', 'llama.layers.22.mlp.gate_proj.weight', 'llama.layers.22.mlp.up_proj.weight', 'llama.layers.22.post_attention_layernorm.weight', 'llama.layers.22.self_attn.k_proj.weight', 'llama.layers.22.self_attn.o_proj.weight', 'llama.layers.22.self_attn.q_proj.weight', 'llama.layers.22.self_attn.v_proj.weight', 'llama.layers.23.input_layernorm.weight', 'llama.layers.23.mlp.down_proj.weight', 'llama.layers.23.mlp.gate_proj.weight', 'llama.layers.23.mlp.up_proj.weight', 'llama.layers.23.post_attention_layernorm.weight', 'llama.layers.23.self_attn.k_proj.weight', 'llama.layers.23.self_attn.o_proj.weight', 'llama.layers.23.self_attn.q_proj.weight', 'llama.layers.23.self_attn.v_proj.weight', 'llama.layers.24.input_layernorm.weight', 'llama.layers.24.mlp.down_proj.weight', 'llama.layers.24.mlp.gate_proj.weight', 'llama.layers.24.mlp.up_proj.weight', 'llama.layers.24.post_attention_layernorm.weight', 'llama.layers.24.self_attn.k_proj.weight', 'llama.layers.24.self_attn.o_proj.weight', 'llama.layers.24.self_attn.q_proj.weight', 'llama.layers.24.self_attn.v_proj.weight', 'llama.layers.25.input_layernorm.weight', 'llama.layers.25.mlp.down_proj.weight', 'llama.layers.25.mlp.gate_proj.weight', 'llama.layers.25.mlp.up_proj.weight', 'llama.layers.25.post_attention_layernorm.weight', 'llama.layers.25.self_attn.k_proj.weight', 'llama.layers.25.self_attn.o_proj.weight', 'llama.layers.25.self_attn.q_proj.weight', 'llama.layers.25.self_attn.v_proj.weight', 'llama.layers.26.input_layernorm.weight', 'llama.layers.26.mlp.down_proj.weight', 'llama.layers.26.mlp.gate_proj.weight', 'llama.layers.26.mlp.up_proj.weight', 'llama.layers.26.post_attention_layernorm.weight', 'llama.layers.26.self_attn.k_proj.weight', 'llama.layers.26.self_attn.o_proj.weight', 'llama.layers.26.self_attn.q_proj.weight', 'llama.layers.26.self_attn.v_proj.weight', 'llama.layers.27.input_layernorm.weight', 'llama.layers.27.mlp.down_proj.weight', 'llama.layers.27.mlp.gate_proj.weight', 'llama.layers.27.mlp.up_proj.weight', 'llama.layers.27.post_attention_layernorm.weight', 'llama.layers.27.self_attn.k_proj.weight', 'llama.layers.27.self_attn.o_proj.weight', 'llama.layers.27.self_attn.q_proj.weight', 'llama.layers.27.self_attn.v_proj.weight', 'llama.layers.28.input_layernorm.weight', 'llama.layers.28.mlp.down_proj.weight', 'llama.layers.28.mlp.gate_proj.weight', 'llama.layers.28.mlp.up_proj.weight', 'llama.layers.28.post_attention_layernorm.weight', 'llama.layers.28.self_attn.k_proj.weight', 'llama.layers.28.self_attn.o_proj.weight', 'llama.layers.28.self_attn.q_proj.weight', 'llama.layers.28.self_attn.v_proj.weight', 'llama.layers.29.input_layernorm.weight', 'llama.layers.29.mlp.down_proj.weight', 'llama.layers.29.mlp.gate_proj.weight', 'llama.layers.29.mlp.up_proj.weight', 'llama.layers.29.post_attention_layernorm.weight', 'llama.layers.29.self_attn.k_proj.weight', 'llama.layers.29.self_attn.o_proj.weight', 'llama.layers.29.self_attn.q_proj.weight', 'llama.layers.29.self_attn.v_proj.weight', 'llama.layers.30.input_layernorm.weight', 'llama.layers.30.mlp.down_proj.weight', 'llama.layers.30.mlp.gate_proj.weight', 'llama.layers.30.mlp.up_proj.weight', 'llama.layers.30.post_attention_layernorm.weight', 'llama.layers.30.self_attn.k_proj.weight', 'llama.layers.30.self_attn.o_proj.weight', 'llama.layers.30.self_attn.q_proj.weight', 'llama.layers.30.self_attn.v_proj.weight', 'llama.layers.31.input_layernorm.weight', 'llama.layers.31.mlp.down_proj.weight', 'llama.layers.31.mlp.gate_proj.weight', 'llama.layers.31.mlp.up_proj.weight', 'llama.layers.31.post_attention_layernorm.weight', 'llama.layers.31.self_attn.k_proj.weight', 'llama.layers.31.self_attn.o_proj.weight', 'llama.layers.31.self_attn.q_proj.weight', 'llama.layers.31.self_attn.v_proj.weight', 'llama.layers.8.input_layernorm.weight', 'llama.layers.8.mlp.down_proj.weight', 'llama.layers.8.mlp.gate_proj.weight', 'llama.layers.8.mlp.up_proj.weight', 'llama.layers.8.post_attention_layernorm.weight', 'llama.layers.8.self_attn.k_proj.weight', 'llama.layers.8.self_attn.o_proj.weight', 'llama.layers.8.self_attn.q_proj.weight', 'llama.layers.8.self_attn.v_proj.weight', 'llama.layers.9.input_layernorm.weight', 'llama.layers.9.mlp.down_proj.weight', 'llama.layers.9.mlp.gate_proj.weight', 'llama.layers.9.mlp.up_proj.weight', 'llama.layers.9.post_attention_layernorm.weight', 'llama.layers.9.self_attn.k_proj.weight', 'llama.layers.9.self_attn.o_proj.weight', 'llama.layers.9.self_attn.q_proj.weight', 'llama.layers.9.self_attn.v_proj.weight', 'llama.norm.weight', 'lm_head.weight']
- This IS expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).[0m
[32m[2024-12-31 16:38:39,430] [    INFO][0m - All the weights of LlamaForCausalLMPipe were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLMPipe for predictions without further training.[0m
[32m[2024-12-31 16:38:40,722] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:38:40,729] [   DEBUG][0m - Frozen parameters: 1.75e+09 || Trainable parameters:5.00e+06 || Total parameters:1.76e+09|| Trainable:0.28%[0m
[35m[2024-12-31 16:38:40,730] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:38:41,292] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:38:41,437] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:38:41,463] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:38:41,464] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - dataset_world_size            : 1[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - enable_sharding_comm_overlap  : False[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - eval_batch_size               : 4[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:38:41,465] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:38:41,466] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-37-07_ubuntu[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:38:41,467] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - optimizer_name_suffix         : pp00[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - per_device_eval_batch_size    : 4[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - per_device_train_batch_size   : 1[0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:38:41,468] [   DEBUG][0m - pipeline_parallel_degree      : 4[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:38:41,469] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding                      : [][0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding_parallel_degree      : 1[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:38:41,470] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - train_batch_size              : 1[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:38:41,471] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - weight_name_suffix            : pp00[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:38:41,472] [   DEBUG][0m - [0m
[32m[2024-12-31 16:38:41,472] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:38:41,475] [    INFO] pipeline_parallel.py:331 - dp_comm_overlap False;             sharding_comm_overlap False;             sharding_split_param False;
[2024-12-31 16:38:41,475] [    INFO] pipeline_parallel.py:404 - Pipeline Info -- num_stages: 4, stage_id: 0
[2024-12-31 16:38:41,475] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:38:41,475] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:38:41) [0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Instantaneous batch size per device = 1[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 4[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Total optimization steps = 377[0m
[32m[2024-12-31 16:38:41,476] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:38:41,477] [   DEBUG][0m -   Number of trainable parameters = 4,997,120 (per device)[0m
[35m[2024-12-31 16:38:41,477] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (all devices, roughly)[0m
W1231 16:38:42.989266 138014 multiply_fwd_func.cc:76] got different data type, run type promotion automatically, this may cause data type been changed.
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8246]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8247]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8244]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8245]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8629]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8631]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8630]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8471]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8470]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8382]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
Error: ../paddle/phi/kernels/funcs/gather.cu.h:67 Assertion `index_value >= 0 && index_value < input_dims[j]` failed. The index is out of bounds, please check whether the dimensions of index and input meet the requirements. It should be less than [8192] and greater than or equal to 0, but received [8383]
CUDA error (/paddle/third_party/flashattn/csrc/flash_attn/src/flash_fwd_launch_template.h:60): unspecified launch failure
terminate called after throwing an instance of 'common::enforce::EnforceNotMet'
  what():  (External) CUDA error(719), unspecified launch failure. 
  [Hint: 'cudaErrorLaunchFailure'. An exception occurred on the device while executing a kernel. Common causes include dereferencing an invalid device pointerand accessing out of bounds shared memory. Less common cases can be system specific - more information about these cases canbe found in the system specific user guide. This leaves the process in an inconsistent state and any further CUDA work willreturn the same error. To continue using CUDA, the process must be terminated and relaunched.] (at ../paddle/phi/backends/gpu/cuda/cuda_info.cc:296)

/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/utils/cpp_extension/extension_utils.py:686: UserWarning: No ccache found. Please be aware that recompiling all source files may be required. You can download and install ccache from: https://github.com/ccache/ccache/blob/master/doc/INSTALL.md
  warnings.warn(warning_message)
/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/_distutils_hack/__init__.py:31: UserWarning: Setuptools is replacing distutils. Support for replacing an already imported distutils is deprecated. In the future, this condition will fail. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
[33m[2024-12-31 16:41:54,513] [ WARNING][0m - sharding_parallel_degree=1 means no sharding, please set sharding to empty![0m
[2024-12-31 16:41:54,513] [    INFO] distributed_strategy.py:333 - distributed strategy initialized
[32m[2024-12-31 16:41:54,514] [    INFO][0m - PP configs:{'micro_batch_size': 1, 'accumulate_steps': 4, 'schedule_mode': '1F1B', 'p2p_cache_shape': True, 'enable_partial_send_recv': True}, use master_grad: False[0m
[33m[2024-12-31 16:41:54,514] [ WARNING][0m - In pipeline model, the evaluation also shares same setting with training. We will enforce that per_device_eval_batch_size=per_device_train_batch_size * gradient_accumulation_steps.[0m
[32m[2024-12-31 16:41:54,514] [    INFO][0m - using pipeline configs:{'delay_scale_loss': False, 'dp_comm_overlap': False, 'sharding_comm_overlap': False, 'enable_timer': False, 'release_gradients': False, 'overlap_p2p_comm': False, 'clear_every_step_cache': False, 'use_batch_p2p_comm': True, 'best_unbalanced_scheduler': False}[0m
======================= Modified FLAGS detected =======================
FLAGS(name='FLAGS_selected_gpus', current_value='0', default_value='')
FLAGS(name='FLAGS_cupti_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cuda_cupti/lib', default_value='')
FLAGS(name='FLAGS_cusparse_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusparse/lib', default_value='')
FLAGS(name='FLAGS_cudnn_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cudnn/lib', default_value='')
FLAGS(name='FLAGS_nccl_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/nccl/lib', default_value='')
FLAGS(name='FLAGS_nvidia_package_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia', default_value='')
FLAGS(name='FLAGS_enable_pir_in_executor', current_value=True, default_value=False)
FLAGS(name='FLAGS_cublas_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cublas/lib', default_value='')
FLAGS(name='FLAGS_cusolver_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/cusolver/lib', default_value='')
FLAGS(name='FLAGS_curand_dir', current_value='/home/sjx/anaconda3/envs/paddle_test/lib/python3.10/site-packages/paddle/../nvidia/curand/lib', default_value='')
=======================================================================
I1231 16:41:54.515234 141488 tcp_utils.cc:181] The server starts to listen on IP_ANY:47469
I1231 16:41:54.515399 141488 tcp_utils.cc:130] Successfully connected to 10.3.242.26:47469
I1231 16:41:54.699460 141488 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:41:54.699527 141488 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:41:54.700395 141488 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:41:54.700428 141488 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:41:54,700] [    INFO] topology.py:370 - Total 1 pipe comm group(s) create successfully!
W1231 16:41:54.731503 141488 gpu_resources.cc:119] Please NOTE: device: 0, GPU Compute Capability: 8.0, Driver API Version: 12.2, Runtime API Version: 11.7
W1231 16:41:54.733625 141488 gpu_resources.cc:164] device: 0, cuDNN Version: 8.9.
[2024-12-31 16:41:57,561] [    INFO] topology.py:370 - Total 4 data comm group(s) create successfully!
[2024-12-31 16:41:57,561] [    INFO] topology.py:370 - Total 4 model comm group(s) create successfully!
[2024-12-31 16:41:57,562] [    INFO] topology.py:370 - Total 4 sharding comm group(s) create successfully!
I1231 16:41:57.562355 141488 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:41:57.562389 141488 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
I1231 16:41:57.562469 141488 process_group_nccl.cc:150] ProcessGroupNCCL pg_timeout_ 1800000
I1231 16:41:57.562480 141488 process_group_nccl.cc:151] ProcessGroupNCCL nccl_comm_init_option_ 0
[2024-12-31 16:41:57,562] [    INFO] topology.py:290 - HybridParallelInfo: rank_id: 0, mp_degree: 1, sharding_degree: 1, pp_degree: 4, dp_degree: 1, sep_degree: 1, mp_group: [0],  sharding_group: [0], pp_group: [0, 1, 2, 3], dp_group: [0], sep:group: None, check/clip group: [0, 1, 2, 3]
[32m[2024-12-31 16:41:57,562] [    INFO][0m -     +==============================================================================+
    |                                                                              |
    |                         DistributedStrategy Overview                         |
    |                                                                              |
    +==============================================================================+
    |                        a_sync=True <-> a_sync_configs                        |
    +------------------------------------------------------------------------------+
    |                               k_steps                    -1                  |
    |                     max_merge_var_num                    1                   |
    |                       send_queue_size                    16                  |
    |               independent_recv_thread                  False                 |
    |         min_send_grad_num_before_recv                    1                   |
    |                      thread_pool_size                    1                   |
    |                       send_wait_times                    1                   |
    |               runtime_split_send_recv                  False                 |
    |                        launch_barrier                   True                 |
    |             heter_worker_device_guard                   cpu                  |
    |                        lr_decay_steps                    10                  |
    |                            use_ps_gpu                    0                   |
    |                         use_gpu_graph                    0                   |
    +==============================================================================+
    |                    Environment Flags, Communication Flags                    |
    +------------------------------------------------------------------------------+
    |                                  mode                    1                   |
    |                               elastic                  False                 |
    |                                  auto                  False                 |
    |                   sync_nccl_allreduce                   True                 |
    |                         nccl_comm_num                    1                   |
    |            use_hierarchical_allreduce                  False                 |
    |   hierarchical_allreduce_inter_nranks                    1                   |
    |                       sync_batch_norm                  False                 |
    |                   fuse_all_reduce_ops                   True                 |
    |                  fuse_grad_size_in_MB                    32                  |
    |              fuse_grad_size_in_TFLOPS                   50.0                 |
    |               cudnn_exhaustive_search                  False                 |
    |             conv_workspace_size_limit                   512                  |
    |    cudnn_batchnorm_spatial_persistent                  False                 |
    |                        fp16_allreduce                  False                 |
    |               last_comm_group_size_MB                   1.0                  |
    |                find_unused_parameters                  False                 |
    |            without_graph_optimization                   True                 |
    |                 fuse_grad_size_in_num                    8                   |
    |                 calc_comm_same_stream                  False                 |
    |                                   asp                  False                 |
    |                       fuse_grad_merge                  False                 |
    |                             semi_auto                  False                 |
    |                            adam_d2sum                  False                 |
    |                           auto_search                  False                 |
    |                        heter_ccl_mode                  False                 |
    |                         is_fl_ps_mode                  False                 |
    |                      with_coordinator                  False                 |
    |                            split_data                   True                 |
    |                  downpour_table_param                    []                  |
    |                       fs_client_param                                        |
    +==============================================================================+
    |                                Build Strategy                                |
    +------------------------------------------------------------------------------+
    |              fuse_elewise_add_act_ops                  False                 |
    |                       fuse_bn_act_ops                  False                 |
    |              fuse_relu_depthwise_conv                  False                 |
    |                    fuse_broadcast_ops                  False                 |
    |                fuse_all_optimizer_ops                  False                 |
    |                        enable_inplace                  False                 |
    |     enable_backward_optimizer_op_deps                   True                 |
    |                 cache_runtime_context                  False                 |
    |                   fuse_bn_add_act_ops                   True                 |
    |                    enable_auto_fusion                  False                 |
    |                          enable_addto                  False                 |
    |              allow_cuda_graph_capture                  False                 |
    |                       reduce_strategy                    0                   |
    |                    fuse_gemm_epilogue                  False                 |
    |                   debug_graphviz_path                                        |
    |                       fused_attention                  False                 |
    |                     fused_feedforward                  False                 |
    |            fuse_dot_product_attention                  False                 |
    |                          fuse_resunit                  False                 |
    +==============================================================================+
[0m
[32m[2024-12-31 16:41:57,564] [    INFO][0m - The default value for the training argument `--report_to` will change in v5 (from all installed integrations to none). In v5, you will need to use `--report_to all` to get the same behavior as now. You should start updating your code and make this info disappear :-).[0m
[35m[2024-12-31 16:41:57,564] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:41:57,564] [   DEBUG][0m -      Model Configuration Arguments      [0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - aistudio_repo_id              : None[0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - aistudio_repo_license         : Apache License 2.0[0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - aistudio_repo_private         : True[0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - aistudio_token                : None[0m
[35m[2024-12-31 16:41:57,565] [   DEBUG][0m - attention_probs_dropout_prob  : 0.1[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - continue_training             : True[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - flash_mask                    : False[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - from_aistudio                 : False[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - fuse_attention_ffn            : None[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - fuse_attention_qkv            : None[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - hidden_dropout_prob           : 0.1[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - lokr                          : False[0m
[35m[2024-12-31 16:41:57,566] [   DEBUG][0m - lokr_dim                      : 8[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - lokr_path                     : None[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - lora                          : True[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - lora_path                     : None[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - lora_plus_scale               : 1.0[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - lora_rank                     : 8[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - lora_use_mixer                : False[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - model_name_or_path            : meta-llama/Llama-2-7b[0m
[35m[2024-12-31 16:41:57,567] [   DEBUG][0m - neftune                       : False[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - neftune_noise_alpha           : 5.0[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - num_prefix_tokens             : 128[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - pissa                         : False[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - prefix_path                   : None[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - prefix_tuning                 : False[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - reft                          : False[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - rope_scaling_factor           : 1.0[0m
[35m[2024-12-31 16:41:57,568] [   DEBUG][0m - rslora                        : False[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - save_to_aistudio              : False[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - strategy_name                 : None[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - strategy_type                 : None[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - tokenizer_name_or_path        : None[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - use_fast_layer_norm           : False[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - use_long_sequence_strategies  : False[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - use_mora                      : False[0m
[35m[2024-12-31 16:41:57,569] [   DEBUG][0m - use_quick_lora                : False[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - vera                          : False[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - vera_rank                     : 8[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - weight_blocksize              : 64[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - weight_double_quant           : False[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - weight_double_quant_block_size: 256[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - weight_quantize_algo          : None[0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - [0m
[35m[2024-12-31 16:41:57,570] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m -       Data Configuration Arguments      [0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - autoregressive                : True[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - chat_template                 : None[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - dataset_name_or_path          : /home/sjx/tr-paddle-1230/train_data[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - eval_with_do_generation       : False[0m
[35m[2024-12-31 16:41:57,571] [   DEBUG][0m - greedy_zero_padding           : False[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - lazy                          : False[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - max_length                    : 8192[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - pad_to_max_length             : False[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - pad_to_multiple_of            : None[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - save_generation_output        : False[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - src_length                    : 4096[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - task_name                     : None[0m
[35m[2024-12-31 16:41:57,572] [   DEBUG][0m - use_pose_convert              : False[0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - zero_padding                  : False[0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - [0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m -    Generation Configuration Arguments   [0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - top_k                         : 1[0m
[35m[2024-12-31 16:41:57,573] [   DEBUG][0m - top_p                         : 1.0[0m
[35m[2024-12-31 16:41:57,574] [   DEBUG][0m - [0m
[32m[2024-12-31 16:41:57,577] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[33m[2024-12-31 16:41:57,577] [ WARNING][0m - Process rank: 0, device: gpu, world_size: 4, distributed training: True, 16-bits training: True[0m
[32m[2024-12-31 16:41:57,579] [    INFO][0m - Loading configuration file /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/config.json[0m
[32m[2024-12-31 16:41:57,583] [    INFO][0m - Final model config: LlamaConfig {
  "alibi": false,
  "architectures": [
    "LlamaForCausalLM"
  ],
  "bos_token_id": 1,
  "dpo_config": null,
  "dtype": "bfloat16",
  "eos_token_id": 2,
  "hidden_act": "silu",
  "hidden_size": 4096,
  "immediate_clear_past_key_value": false,
  "initializer_range": 0.02,
  "intermediate_size": 11008,
  "long_sequence_init_args": {},
  "long_sequence_strategy_name": null,
  "long_sequence_strategy_type": null,
  "max_position_embeddings": 4096,
  "model_type": "llama",
  "num_attention_heads": 32,
  "num_hidden_layers": 32,
  "num_key_value_heads": 32,
  "pad_token_id": 0,
  "paddlenlp_version": "3.0.0b3.post20241231",
  "pipeline_parallel_degree": 4,
  "pretraining_tp": 1,
  "recompute": true,
  "refined_recompute": {},
  "rms_norm_eps": 1e-05,
  "rope_scaling": null,
  "rope_scaling_factor": 2.0,
  "rope_scaling_type": "linear",
  "rope_theta": 10000.0,
  "seq_length": 8192,
  "tensor_parallel_output": false,
  "tie_word_embeddings": false,
  "use_fast_layer_norm": false,
  "use_flash_attention": true,
  "use_flash_attention_for_generation": false,
  "use_last_token_for_generation": false,
  "use_long_sequence_strategies": false,
  "vocab_size": 32000
}
[0m
[32m[2024-12-31 16:41:57,584] [    INFO][0m - We are using <class 'paddlenlp.transformers.llama.modeling_pp.LlamaForCausalLMPipe'> to load 'meta-llama/Llama-2-7b'.[0m
[32m[2024-12-31 16:41:57,584] [    INFO][0m - Loading weights file from cache at /home/sjx/.paddlenlp/models/meta-llama/Llama-2-7b/model_state.pdparams[0m
[32m[2024-12-31 16:43:06,915] [    INFO][0m - Loaded weights file from disk, setting weights to model.[0m
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:609 - start segment network..
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:615 - segment with method: layer:LlamaDecoderLayer; result: 0, 9, 17, 25, 35
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:631 - stage=0, global_rank=0 ,layer_number=9
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 0: LlamaEmbeddingPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 1: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 2: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 3: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 4: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 5: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 6: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 7: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 8: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:631 - stage=1, global_rank=0 ,layer_number=8
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 9: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 10: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 11: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 12: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 13: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 14: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 15: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 16: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:631 - stage=2, global_rank=0 ,layer_number=8
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 17: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 18: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 19: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 20: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 21: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 22: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 23: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 24: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:631 - stage=3, global_rank=0 ,layer_number=10
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 25: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 26: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 27: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 28: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 29: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 30: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 31: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 32: LlamaDecoderLayerPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 33: LlamaRMSNormPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:636 - 34: LlamaLMHeadPipe
[2024-12-31 16:43:06,920] [    INFO] pp_layers.py:658 - loss: LlamaPretrainingCriterion
[2024-12-31 16:43:06,997] [    INFO] pp_layers.py:708 - flush 9 of layers into run_function
[33m[2024-12-31 16:43:28,887] [ WARNING][0m - Some weights of the model checkpoint at meta-llama/Llama-2-7b were not used when initializing LlamaForCausalLMPipe: ['llama.layers.10.input_layernorm.weight', 'llama.layers.10.mlp.down_proj.weight', 'llama.layers.10.mlp.gate_proj.weight', 'llama.layers.10.mlp.up_proj.weight', 'llama.layers.10.post_attention_layernorm.weight', 'llama.layers.10.self_attn.k_proj.weight', 'llama.layers.10.self_attn.o_proj.weight', 'llama.layers.10.self_attn.q_proj.weight', 'llama.layers.10.self_attn.v_proj.weight', 'llama.layers.11.input_layernorm.weight', 'llama.layers.11.mlp.down_proj.weight', 'llama.layers.11.mlp.gate_proj.weight', 'llama.layers.11.mlp.up_proj.weight', 'llama.layers.11.post_attention_layernorm.weight', 'llama.layers.11.self_attn.k_proj.weight', 'llama.layers.11.self_attn.o_proj.weight', 'llama.layers.11.self_attn.q_proj.weight', 'llama.layers.11.self_attn.v_proj.weight', 'llama.layers.12.input_layernorm.weight', 'llama.layers.12.mlp.down_proj.weight', 'llama.layers.12.mlp.gate_proj.weight', 'llama.layers.12.mlp.up_proj.weight', 'llama.layers.12.post_attention_layernorm.weight', 'llama.layers.12.self_attn.k_proj.weight', 'llama.layers.12.self_attn.o_proj.weight', 'llama.layers.12.self_attn.q_proj.weight', 'llama.layers.12.self_attn.v_proj.weight', 'llama.layers.13.input_layernorm.weight', 'llama.layers.13.mlp.down_proj.weight', 'llama.layers.13.mlp.gate_proj.weight', 'llama.layers.13.mlp.up_proj.weight', 'llama.layers.13.post_attention_layernorm.weight', 'llama.layers.13.self_attn.k_proj.weight', 'llama.layers.13.self_attn.o_proj.weight', 'llama.layers.13.self_attn.q_proj.weight', 'llama.layers.13.self_attn.v_proj.weight', 'llama.layers.14.input_layernorm.weight', 'llama.layers.14.mlp.down_proj.weight', 'llama.layers.14.mlp.gate_proj.weight', 'llama.layers.14.mlp.up_proj.weight', 'llama.layers.14.post_attention_layernorm.weight', 'llama.layers.14.self_attn.k_proj.weight', 'llama.layers.14.self_attn.o_proj.weight', 'llama.layers.14.self_attn.q_proj.weight', 'llama.layers.14.self_attn.v_proj.weight', 'llama.layers.15.input_layernorm.weight', 'llama.layers.15.mlp.down_proj.weight', 'llama.layers.15.mlp.gate_proj.weight', 'llama.layers.15.mlp.up_proj.weight', 'llama.layers.15.post_attention_layernorm.weight', 'llama.layers.15.self_attn.k_proj.weight', 'llama.layers.15.self_attn.o_proj.weight', 'llama.layers.15.self_attn.q_proj.weight', 'llama.layers.15.self_attn.v_proj.weight', 'llama.layers.16.input_layernorm.weight', 'llama.layers.16.mlp.down_proj.weight', 'llama.layers.16.mlp.gate_proj.weight', 'llama.layers.16.mlp.up_proj.weight', 'llama.layers.16.post_attention_layernorm.weight', 'llama.layers.16.self_attn.k_proj.weight', 'llama.layers.16.self_attn.o_proj.weight', 'llama.layers.16.self_attn.q_proj.weight', 'llama.layers.16.self_attn.v_proj.weight', 'llama.layers.17.input_layernorm.weight', 'llama.layers.17.mlp.down_proj.weight', 'llama.layers.17.mlp.gate_proj.weight', 'llama.layers.17.mlp.up_proj.weight', 'llama.layers.17.post_attention_layernorm.weight', 'llama.layers.17.self_attn.k_proj.weight', 'llama.layers.17.self_attn.o_proj.weight', 'llama.layers.17.self_attn.q_proj.weight', 'llama.layers.17.self_attn.v_proj.weight', 'llama.layers.18.input_layernorm.weight', 'llama.layers.18.mlp.down_proj.weight', 'llama.layers.18.mlp.gate_proj.weight', 'llama.layers.18.mlp.up_proj.weight', 'llama.layers.18.post_attention_layernorm.weight', 'llama.layers.18.self_attn.k_proj.weight', 'llama.layers.18.self_attn.o_proj.weight', 'llama.layers.18.self_attn.q_proj.weight', 'llama.layers.18.self_attn.v_proj.weight', 'llama.layers.19.input_layernorm.weight', 'llama.layers.19.mlp.down_proj.weight', 'llama.layers.19.mlp.gate_proj.weight', 'llama.layers.19.mlp.up_proj.weight', 'llama.layers.19.post_attention_layernorm.weight', 'llama.layers.19.self_attn.k_proj.weight', 'llama.layers.19.self_attn.o_proj.weight', 'llama.layers.19.self_attn.q_proj.weight', 'llama.layers.19.self_attn.v_proj.weight', 'llama.layers.20.input_layernorm.weight', 'llama.layers.20.mlp.down_proj.weight', 'llama.layers.20.mlp.gate_proj.weight', 'llama.layers.20.mlp.up_proj.weight', 'llama.layers.20.post_attention_layernorm.weight', 'llama.layers.20.self_attn.k_proj.weight', 'llama.layers.20.self_attn.o_proj.weight', 'llama.layers.20.self_attn.q_proj.weight', 'llama.layers.20.self_attn.v_proj.weight', 'llama.layers.21.input_layernorm.weight', 'llama.layers.21.mlp.down_proj.weight', 'llama.layers.21.mlp.gate_proj.weight', 'llama.layers.21.mlp.up_proj.weight', 'llama.layers.21.post_attention_layernorm.weight', 'llama.layers.21.self_attn.k_proj.weight', 'llama.layers.21.self_attn.o_proj.weight', 'llama.layers.21.self_attn.q_proj.weight', 'llama.layers.21.self_attn.v_proj.weight', 'llama.layers.22.input_layernorm.weight', 'llama.layers.22.mlp.down_proj.weight', 'llama.layers.22.mlp.gate_proj.weight', 'llama.layers.22.mlp.up_proj.weight', 'llama.layers.22.post_attention_layernorm.weight', 'llama.layers.22.self_attn.k_proj.weight', 'llama.layers.22.self_attn.o_proj.weight', 'llama.layers.22.self_attn.q_proj.weight', 'llama.layers.22.self_attn.v_proj.weight', 'llama.layers.23.input_layernorm.weight', 'llama.layers.23.mlp.down_proj.weight', 'llama.layers.23.mlp.gate_proj.weight', 'llama.layers.23.mlp.up_proj.weight', 'llama.layers.23.post_attention_layernorm.weight', 'llama.layers.23.self_attn.k_proj.weight', 'llama.layers.23.self_attn.o_proj.weight', 'llama.layers.23.self_attn.q_proj.weight', 'llama.layers.23.self_attn.v_proj.weight', 'llama.layers.24.input_layernorm.weight', 'llama.layers.24.mlp.down_proj.weight', 'llama.layers.24.mlp.gate_proj.weight', 'llama.layers.24.mlp.up_proj.weight', 'llama.layers.24.post_attention_layernorm.weight', 'llama.layers.24.self_attn.k_proj.weight', 'llama.layers.24.self_attn.o_proj.weight', 'llama.layers.24.self_attn.q_proj.weight', 'llama.layers.24.self_attn.v_proj.weight', 'llama.layers.25.input_layernorm.weight', 'llama.layers.25.mlp.down_proj.weight', 'llama.layers.25.mlp.gate_proj.weight', 'llama.layers.25.mlp.up_proj.weight', 'llama.layers.25.post_attention_layernorm.weight', 'llama.layers.25.self_attn.k_proj.weight', 'llama.layers.25.self_attn.o_proj.weight', 'llama.layers.25.self_attn.q_proj.weight', 'llama.layers.25.self_attn.v_proj.weight', 'llama.layers.26.input_layernorm.weight', 'llama.layers.26.mlp.down_proj.weight', 'llama.layers.26.mlp.gate_proj.weight', 'llama.layers.26.mlp.up_proj.weight', 'llama.layers.26.post_attention_layernorm.weight', 'llama.layers.26.self_attn.k_proj.weight', 'llama.layers.26.self_attn.o_proj.weight', 'llama.layers.26.self_attn.q_proj.weight', 'llama.layers.26.self_attn.v_proj.weight', 'llama.layers.27.input_layernorm.weight', 'llama.layers.27.mlp.down_proj.weight', 'llama.layers.27.mlp.gate_proj.weight', 'llama.layers.27.mlp.up_proj.weight', 'llama.layers.27.post_attention_layernorm.weight', 'llama.layers.27.self_attn.k_proj.weight', 'llama.layers.27.self_attn.o_proj.weight', 'llama.layers.27.self_attn.q_proj.weight', 'llama.layers.27.self_attn.v_proj.weight', 'llama.layers.28.input_layernorm.weight', 'llama.layers.28.mlp.down_proj.weight', 'llama.layers.28.mlp.gate_proj.weight', 'llama.layers.28.mlp.up_proj.weight', 'llama.layers.28.post_attention_layernorm.weight', 'llama.layers.28.self_attn.k_proj.weight', 'llama.layers.28.self_attn.o_proj.weight', 'llama.layers.28.self_attn.q_proj.weight', 'llama.layers.28.self_attn.v_proj.weight', 'llama.layers.29.input_layernorm.weight', 'llama.layers.29.mlp.down_proj.weight', 'llama.layers.29.mlp.gate_proj.weight', 'llama.layers.29.mlp.up_proj.weight', 'llama.layers.29.post_attention_layernorm.weight', 'llama.layers.29.self_attn.k_proj.weight', 'llama.layers.29.self_attn.o_proj.weight', 'llama.layers.29.self_attn.q_proj.weight', 'llama.layers.29.self_attn.v_proj.weight', 'llama.layers.30.input_layernorm.weight', 'llama.layers.30.mlp.down_proj.weight', 'llama.layers.30.mlp.gate_proj.weight', 'llama.layers.30.mlp.up_proj.weight', 'llama.layers.30.post_attention_layernorm.weight', 'llama.layers.30.self_attn.k_proj.weight', 'llama.layers.30.self_attn.o_proj.weight', 'llama.layers.30.self_attn.q_proj.weight', 'llama.layers.30.self_attn.v_proj.weight', 'llama.layers.31.input_layernorm.weight', 'llama.layers.31.mlp.down_proj.weight', 'llama.layers.31.mlp.gate_proj.weight', 'llama.layers.31.mlp.up_proj.weight', 'llama.layers.31.post_attention_layernorm.weight', 'llama.layers.31.self_attn.k_proj.weight', 'llama.layers.31.self_attn.o_proj.weight', 'llama.layers.31.self_attn.q_proj.weight', 'llama.layers.31.self_attn.v_proj.weight', 'llama.layers.8.input_layernorm.weight', 'llama.layers.8.mlp.down_proj.weight', 'llama.layers.8.mlp.gate_proj.weight', 'llama.layers.8.mlp.up_proj.weight', 'llama.layers.8.post_attention_layernorm.weight', 'llama.layers.8.self_attn.k_proj.weight', 'llama.layers.8.self_attn.o_proj.weight', 'llama.layers.8.self_attn.q_proj.weight', 'llama.layers.8.self_attn.v_proj.weight', 'llama.layers.9.input_layernorm.weight', 'llama.layers.9.mlp.down_proj.weight', 'llama.layers.9.mlp.gate_proj.weight', 'llama.layers.9.mlp.up_proj.weight', 'llama.layers.9.post_attention_layernorm.weight', 'llama.layers.9.self_attn.k_proj.weight', 'llama.layers.9.self_attn.o_proj.weight', 'llama.layers.9.self_attn.q_proj.weight', 'llama.layers.9.self_attn.v_proj.weight', 'llama.norm.weight', 'lm_head.weight']
- This IS expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing LlamaForCausalLMPipe from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).[0m
[32m[2024-12-31 16:43:28,888] [    INFO][0m - All the weights of LlamaForCausalLMPipe were initialized from the model checkpoint at meta-llama/Llama-2-7b.
If your task is similar to the task the model of the checkpoint was trained on, you can already use LlamaForCausalLMPipe for predictions without further training.[0m
[32m[2024-12-31 16:43:30,166] [    INFO][0m - Mark only lora and trainable_module as trainable.[0m
[35m[2024-12-31 16:43:30,171] [   DEBUG][0m - Frozen parameters: 1.75e+09 || Trainable parameters:5.00e+06 || Total parameters:1.76e+09|| Trainable:0.28%[0m
[35m[2024-12-31 16:43:30,171] [   DEBUG][0m - 0: main local process completed work, releasing all replicas[0m
[32m[2024-12-31 16:43:30,726] [    INFO][0m - The global seed is set to 42, local seed is set to 46 and random seed is set to 42.[0m
[32m[2024-12-31 16:43:30,863] [    INFO][0m - Using half precision[0m
[35m[2024-12-31 16:43:30,887] [   DEBUG][0m - ============================================================[0m
[35m[2024-12-31 16:43:30,887] [   DEBUG][0m -     Training Configuration Arguments    [0m
[35m[2024-12-31 16:43:30,887] [   DEBUG][0m - paddle commit id              : 396a3f594f154081b444a3ab40e7f28d89c32521[0m
[35m[2024-12-31 16:43:30,887] [   DEBUG][0m - paddlenlp commit id           : 79695ccd747b5a6b18bdec65503aacd419ca9a46.dirty[0m
[35m[2024-12-31 16:43:30,887] [   DEBUG][0m - _no_sync_in_gradient_accumulation: True[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - adam_beta1                    : 0.9[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - adam_beta2                    : 0.999[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - adam_epsilon                  : 1e-08[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - amp_custom_black_list         : None[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - amp_custom_white_list         : None[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - amp_master_grad               : False[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - auto_parallel_resume_form_hybrid_parallel: False[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - autotuner_benchmark           : False[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - benchmark                     : False[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - bf16                          : True[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - bf16_full_eval                : False[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - ckpt_quant_stage              : O0[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - context_parallel_degree       : 1[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - current_device                : gpu:0[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - data_parallel_config          : [0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - data_parallel_degree          : 1[0m
[35m[2024-12-31 16:43:30,888] [   DEBUG][0m - data_parallel_rank            : 0[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataloader_drop_last          : False[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataloader_num_workers        : 0[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataset_batch_size            : 1000[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataset_kwargs                : {}[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataset_num_proc              : None[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataset_rank                  : 0[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataset_text_field            : text[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - dataset_world_size            : 1[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - ddp_find_unused_parameters    : None[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - decay_steps                   : 0[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - device                        : gpu[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - disable_tqdm                  : True[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - distributed_dataloader        : False[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - do_eval                       : False[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - do_export                     : False[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - do_predict                    : False[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - do_train                      : True[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - enable_auto_parallel          : False[0m
[35m[2024-12-31 16:43:30,889] [   DEBUG][0m - enable_sharding_comm_overlap  : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - eval_accumulation_steps       : 16[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - eval_batch_size               : 4[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - eval_packing                  : None[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - eval_steps                    : None[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - evaluation_strategy           : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - expert_max_capacity           : 4294967296[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - expert_min_capacity           : 1[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - flatten_param_grads           : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - force_reshard_pp              : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - fp16                          : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - fp16_full_eval                : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - fp16_opt_level                : O2[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - fuse_sequence_parallel_allreduce: False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - gradient_accumulation_steps   : 4[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - greater_is_better             : True[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - hybrid_parallel_topo_order    : pp_first[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - ignore_data_skip              : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - ignore_load_lr_and_optim      : False[0m
[35m[2024-12-31 16:43:30,890] [   DEBUG][0m - ignore_save_lr_and_optim      : False[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - label_names                   : None[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - lazy_data_processing          : True[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - learning_rate                 : 0.0003[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - load_best_model_at_end        : True[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - load_sharded_model            : False[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - local_process_index           : 0[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - local_rank                    : 0[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - log_level                     : -1[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - log_level_replica             : -1[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - log_on_each_node              : True[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - logging_dir                   : ./checkpoints/lora_ckpts/runs/Dec31_16-41-54_ubuntu[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - logging_first_step            : False[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - logging_steps                 : 1[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - logging_strategy              : IntervalStrategy.STEPS[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - logical_process_index         : 0[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - lr_end                        : 1e-07[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - lr_scheduler_type             : SchedulerType.LINEAR[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - max_evaluate_steps            : -1[0m
[35m[2024-12-31 16:43:30,891] [   DEBUG][0m - max_grad_norm                 : 1.0[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - max_seq_length                : 2048[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - max_steps                     : -1[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - metric_for_best_model         : accuracy[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - minimum_eval_times            : None[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - model_init_kwargs             : None[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - no_cuda                       : False[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - no_recompute_layers           : None[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - num_cycles                    : 0.5[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - num_train_epochs              : 1.0[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - offload_optim                 : False[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - optim                         : OptimizerNames.ADAMW[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - optimizer_name_suffix         : pp00[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - ordered_save_group_size       : 0[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - output_dir                    : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - output_signal_dir             : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - overwrite_output_dir          : False[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - past_index                    : -1[0m
[35m[2024-12-31 16:43:30,892] [   DEBUG][0m - per_device_eval_batch_size    : 4[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - per_device_train_batch_size   : 1[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - pipeline_parallel_config      : [0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - pipeline_parallel_degree      : 4[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - pipeline_parallel_rank        : 0[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - power                         : 1.0[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - pp_recompute_interval         : 1[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - prediction_loss_only          : False[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - process_index                 : 0[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - recompute                     : True[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - recompute_granularity         : full[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - recompute_use_reentrant       : False[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - refined_recompute             : [0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - release_grads                 : False[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - remove_unused_columns         : True[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - report_to                     : ['visualdl'][0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - resume_from_checkpoint        : None[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - run_name                      : ./checkpoints/lora_ckpts[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - save_on_each_node             : False[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - save_sharded_model            : False[0m
[35m[2024-12-31 16:43:30,893] [   DEBUG][0m - save_steps                    : 500[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - save_strategy                 : IntervalStrategy.EPOCH[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - save_total_limit              : 1[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - scale_loss                    : 32768[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - seed                          : 42[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sep_parallel_degree           : 1[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sequence_parallel             : False[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sequence_parallel_config      : [0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding                      : [][0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding_comm_buffer_size_MB  : -1[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding_degree               : -1[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding_parallel_config      : [0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding_parallel_degree      : 1[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding_parallel_mesh_dimension: dp[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - sharding_parallel_rank        : 0[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - should_load_dataset           : True[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - should_load_sharding_stage1_model: False[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - should_log                    : True[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - should_save                   : True[0m
[35m[2024-12-31 16:43:30,894] [   DEBUG][0m - should_save_model_state       : True[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - should_save_sharding_stage1_model: False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - skip_data_intervals           : None[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - skip_memory_metrics           : True[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - skip_profile_timer            : True[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - skip_recompute_ops            : None[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - tensor_parallel_config        : [0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - tensor_parallel_degree        : 1[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - tensor_parallel_output        : False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - tensor_parallel_rank          : 0[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - to_static                     : False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - train_batch_size              : 1[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - unified_checkpoint            : True[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - unified_checkpoint_config     : [''][0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - use_async_save                : False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - use_expert_parallel           : False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - use_flash_attention           : True[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - use_fused_dropout_add         : False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - use_fused_linear              : False[0m
[35m[2024-12-31 16:43:30,895] [   DEBUG][0m - use_fused_rms_norm            : False[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - use_fused_rope                : False[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - use_hybrid_parallel           : True[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - virtual_pp_degree             : 1[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - wandb_api_key                 : None[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - warmup_ratio                  : 0.0[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - warmup_steps                  : 30[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - weight_decay                  : 0.0[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - weight_name_suffix            : pp00[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - world_size                    : 4[0m
[35m[2024-12-31 16:43:30,896] [   DEBUG][0m - [0m
[32m[2024-12-31 16:43:30,896] [    INFO][0m - Starting training from resume_from_checkpoint : None[0m
[2024-12-31 16:43:30,899] [    INFO] pipeline_parallel.py:331 - dp_comm_overlap False;             sharding_comm_overlap False;             sharding_split_param False;
[2024-12-31 16:43:30,899] [    INFO] pipeline_parallel.py:404 - Pipeline Info -- num_stages: 4, stage_id: 0
[2024-12-31 16:43:30,899] [ WARNING] hybrid_parallel_optimizer.py:313 - While using ClipGradByGlobalNorm in TensorParallel, PipelineParallel or Sharding, the grad clip of original optimizer will be changed.
[32m[2024-12-31 16:43:30,899] [    INFO][0m - [timelog] checkpoint loading time: 0.00s (2024-12-31 16:43:30) [0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m - ***** Running training *****[0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m -   Num examples = 1,510[0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m -   Num Epochs = 1[0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m -   Instantaneous batch size per device = 1[0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m -   Total train batch size (w. parallel, distributed & accumulation) = 4[0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m -   Gradient Accumulation steps = 4[0m
[32m[2024-12-31 16:43:30,899] [    INFO][0m -   Total optimization steps = 377[0m
[32m[2024-12-31 16:43:30,900] [    INFO][0m -   Total num train samples = 1,510[0m
[35m[2024-12-31 16:43:30,901] [   DEBUG][0m -   Number of trainable parameters = 4,997,120 (per device)[0m
[35m[2024-12-31 16:43:30,902] [   DEBUG][0m -   Number of trainable parameters = 19,988,480 (all devices, roughly)[0m
W1231 16:43:32.354391 141488 multiply_fwd_func.cc:76] got different data type, run type promotion automatically, this may cause data type been changed.
[32m[2024-12-31 16:43:39,902] [    INFO][0m - loss: 5.05923414, learning_rate: 1e-05, global_step: 1, current_memory_allocated: 3.365605115890503, current_memory_reserved: 16.908264875411987, max_memory_allocated: 15.545772790908813, max_memory_reserved: 16.908264875411987, interval_runtime: 8.9984, interval_samples_per_second: 0.4445, interval_steps_per_second: 0.1111, ppl: 157.46987025543132, progress_or_epoch: 0.0026[0m
[32m[2024-12-31 16:43:45,721] [    INFO][0m - loss: 4.08779478, learning_rate: 2e-05, global_step: 2, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.819, interval_samples_per_second: 0.6874, interval_steps_per_second: 0.1719, ppl: 59.60829725085015, progress_or_epoch: 0.0053[0m
[32m[2024-12-31 16:43:51,461] [    INFO][0m - loss: 3.85671139, learning_rate: 3e-05, global_step: 3, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.739, interval_samples_per_second: 0.697, interval_steps_per_second: 0.1742, ppl: 47.30951272639637, progress_or_epoch: 0.0079[0m
[32m[2024-12-31 16:43:57,413] [    INFO][0m - loss: 5.62762403, learning_rate: 4e-05, global_step: 4, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9518, interval_samples_per_second: 0.6721, interval_steps_per_second: 0.168, ppl: 278.000810735185, progress_or_epoch: 0.0106[0m
[32m[2024-12-31 16:44:03,257] [    INFO][0m - loss: 1.34156585, learning_rate: 5e-05, global_step: 5, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8446, interval_samples_per_second: 0.6844, interval_steps_per_second: 0.1711, ppl: 3.825028239013981, progress_or_epoch: 0.0132[0m
[32m[2024-12-31 16:44:09,169] [    INFO][0m - loss: 8.29961777, learning_rate: 6e-05, global_step: 6, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9125, interval_samples_per_second: 0.6765, interval_steps_per_second: 0.1691, ppl: 4022.3346429831904, progress_or_epoch: 0.0159[0m
[32m[2024-12-31 16:44:15,164] [    INFO][0m - loss: 4.46338224, learning_rate: 7e-05, global_step: 7, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9951, interval_samples_per_second: 0.6672, interval_steps_per_second: 0.1668, ppl: 86.78052585626685, progress_or_epoch: 0.0185[0m
[32m[2024-12-31 16:44:21,164] [    INFO][0m - loss: 1.4660852, learning_rate: 8e-05, global_step: 8, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9995, interval_samples_per_second: 0.6667, interval_steps_per_second: 0.1667, ppl: 4.33224203933237, progress_or_epoch: 0.0212[0m
[32m[2024-12-31 16:44:27,052] [    INFO][0m - loss: 1.2737999, learning_rate: 9e-05, global_step: 9, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.888, interval_samples_per_second: 0.6794, interval_steps_per_second: 0.1698, ppl: 3.5744091866031793, progress_or_epoch: 0.0238[0m
[32m[2024-12-31 16:44:32,747] [    INFO][0m - loss: 3.9989202, learning_rate: 0.0001, global_step: 10, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.6961, interval_samples_per_second: 0.7022, interval_steps_per_second: 0.1756, ppl: 54.53922676913391, progress_or_epoch: 0.0265[0m
[32m[2024-12-31 16:44:38,397] [    INFO][0m - loss: 2.6147542, learning_rate: 0.00011, global_step: 11, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.6501, interval_samples_per_second: 0.708, interval_steps_per_second: 0.177, ppl: 13.663857388944752, progress_or_epoch: 0.0291[0m
[32m[2024-12-31 16:44:44,288] [    INFO][0m - loss: 1.77159572, learning_rate: 0.00012, global_step: 12, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8907, interval_samples_per_second: 0.679, interval_steps_per_second: 0.1698, ppl: 5.880229078028244, progress_or_epoch: 0.0318[0m
[32m[2024-12-31 16:44:50,113] [    INFO][0m - loss: 3.63261962, learning_rate: 0.00013, global_step: 13, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8248, interval_samples_per_second: 0.6867, interval_steps_per_second: 0.1717, ppl: 37.811739379300796, progress_or_epoch: 0.0344[0m
[32m[2024-12-31 16:44:55,987] [    INFO][0m - loss: 1.56913853, learning_rate: 0.00014, global_step: 14, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8737, interval_samples_per_second: 0.681, interval_steps_per_second: 0.1703, ppl: 4.80250919362389, progress_or_epoch: 0.0371[0m
[32m[2024-12-31 16:45:01,752] [    INFO][0m - loss: 1.20668888, learning_rate: 0.00015, global_step: 15, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.7653, interval_samples_per_second: 0.6938, interval_steps_per_second: 0.1735, ppl: 3.3423992251643724, progress_or_epoch: 0.0397[0m
[32m[2024-12-31 16:45:07,633] [    INFO][0m - loss: 1.07887936, learning_rate: 0.00016, global_step: 16, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8818, interval_samples_per_second: 0.6801, interval_steps_per_second: 0.17, ppl: 2.941381473697282, progress_or_epoch: 0.0424[0m
[32m[2024-12-31 16:45:13,480] [    INFO][0m - loss: 1.43353999, learning_rate: 0.00017, global_step: 17, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8464, interval_samples_per_second: 0.6842, interval_steps_per_second: 0.171, ppl: 4.193517958944048, progress_or_epoch: 0.045[0m
[32m[2024-12-31 16:45:19,287] [    INFO][0m - loss: 3.00756907, learning_rate: 0.00018, global_step: 18, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8067, interval_samples_per_second: 0.6889, interval_steps_per_second: 0.1722, ppl: 20.238142570987623, progress_or_epoch: 0.0477[0m
[32m[2024-12-31 16:45:25,230] [    INFO][0m - loss: 1.23114049, learning_rate: 0.00019, global_step: 19, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9433, interval_samples_per_second: 0.673, interval_steps_per_second: 0.1683, ppl: 3.4251336402360937, progress_or_epoch: 0.0503[0m
[32m[2024-12-31 16:45:30,927] [    INFO][0m - loss: 2.28834176, learning_rate: 0.0002, global_step: 20, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.6969, interval_samples_per_second: 0.7021, interval_steps_per_second: 0.1755, ppl: 9.858576233865115, progress_or_epoch: 0.053[0m
[32m[2024-12-31 16:45:36,798] [    INFO][0m - loss: 2.79398084, learning_rate: 0.00021, global_step: 21, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.8706, interval_samples_per_second: 0.6814, interval_steps_per_second: 0.1703, ppl: 16.345961111376752, progress_or_epoch: 0.0556[0m
[32m[2024-12-31 16:45:42,713] [    INFO][0m - loss: 2.17879868, learning_rate: 0.00022, global_step: 22, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9147, interval_samples_per_second: 0.6763, interval_steps_per_second: 0.1691, ppl: 8.835685394891533, progress_or_epoch: 0.0583[0m
[32m[2024-12-31 16:45:48,460] [    INFO][0m - loss: 1.33511174, learning_rate: 0.00023, global_step: 23, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.7475, interval_samples_per_second: 0.696, interval_steps_per_second: 0.174, ppl: 3.8004205816902537, progress_or_epoch: 0.0609[0m
[32m[2024-12-31 16:45:54,143] [    INFO][0m - loss: 3.8207984, learning_rate: 0.00024, global_step: 24, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.6826, interval_samples_per_second: 0.7039, interval_steps_per_second: 0.176, ppl: 45.64063325967279, progress_or_epoch: 0.0636[0m
[32m[2024-12-31 16:46:00,192] [    INFO][0m - loss: 2.27230501, learning_rate: 0.00025, global_step: 25, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 6.0491, interval_samples_per_second: 0.6613, interval_steps_per_second: 0.1653, ppl: 9.7017376631838, progress_or_epoch: 0.0662[0m
[32m[2024-12-31 16:46:06,389] [    INFO][0m - loss: 2.56206465, learning_rate: 0.00026, global_step: 26, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 6.1973, interval_samples_per_second: 0.6454, interval_steps_per_second: 0.1614, ppl: 12.962552841017644, progress_or_epoch: 0.0689[0m
[32m[2024-12-31 16:46:12,625] [    INFO][0m - loss: 1.49910939, learning_rate: 0.00027, global_step: 27, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 6.2357, interval_samples_per_second: 0.6415, interval_steps_per_second: 0.1604, ppl: 4.477699410114489, progress_or_epoch: 0.0715[0m
[32m[2024-12-31 16:46:18,336] [    INFO][0m - loss: 3.15382099, learning_rate: 0.00028, global_step: 28, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.7113, interval_samples_per_second: 0.7004, interval_steps_per_second: 0.1751, ppl: 23.42540202038362, progress_or_epoch: 0.0742[0m
[32m[2024-12-31 16:46:24,274] [    INFO][0m - loss: 1.50329626, learning_rate: 0.00029, global_step: 29, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.9383, interval_samples_per_second: 0.6736, interval_steps_per_second: 0.1684, ppl: 4.496486257042356, progress_or_epoch: 0.0768[0m
[32m[2024-12-31 16:46:30,043] [    INFO][0m - loss: 1.27348042, learning_rate: 0.0003, global_step: 30, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.7686, interval_samples_per_second: 0.6934, interval_steps_per_second: 0.1734, ppl: 3.573267416752271, progress_or_epoch: 0.0795[0m
[32m[2024-12-31 16:46:35,818] [    INFO][0m - loss: 0.97757012, learning_rate: 0.0002991, global_step: 31, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.7746, interval_samples_per_second: 0.6927, interval_steps_per_second: 0.1732, ppl: 2.6579897925259792, progress_or_epoch: 0.0821[0m
[32m[2024-12-31 16:46:41,491] [    INFO][0m - loss: 2.89578819, learning_rate: 0.0002983, global_step: 32, current_memory_allocated: 3.365605115890503, current_memory_reserved: 17.244202375411987, max_memory_allocated: 15.603947162628174, max_memory_reserved: 17.244202375411987, interval_runtime: 5.6731, interval_samples_per_second: 0.7051, interval_steps_per_second: 0.1763, ppl: 18.097760294863463, progress_or_epoch: 0.0848[0m
